{"version":3,"sources":["webpack:///./src/views/Mall/Cart.vue?8b0c","webpack:///./src/views/Mall/Cart.vue","webpack:///./src/views/Mall/Cart.vue?96af"],"names":["class","title","subtitle","extra","to","state","refreshing","loading-text","getList","description","type","size","authorized","empty","list","item","index","key","justify","align","span","checked","disabled","getError","length","onChange","id","width","height","radius","fit","src","image","$router","push","spu","right","square","text","onRemove","border","label","spec","center","price","num","theme","button-size","min","max","stock","status","integer","style","amount","button-text","total","onSubmit","__exports__","render","components","BaseLayout","data","created","this","computed","_","isEmpty","methods","$http","get","then","i","stat","parseInt","cartNumberSet","like","post","omit","obj","has","$notify"],"mappings":"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","file":"asset/js/chunk-36e08241.c5c8b79f.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Cart.vue?vue&type=style&index=0&id=59f993fe&scoped=true&lang=css\"","<template>\n  <BaseLayout title=\"购物车\" subtitle=\"更多操作请按住商品标题左滑\">\n\n    <template #extra>\n      <van-button class=\"extra\" to=\"/jdmall/cart\">查看京东购物车</van-button>\n    </template>\n\n    <van-pull-refresh class=\"list\" v-model=\"state.refreshing\" loading-text=\" \" @refresh=\"getList\">\n\n      <van-empty v-show=\"empty\" description=\"购物车空空如也 ~\">\n        <van-button v-show=\"!authorized\" type=\"primary\" size=\"small\" to=\"/login\">请先登录</van-button>\n      </van-empty>\n\n      <van-row v-for=\"(item, index) in state.list\" :key=\"index\" class=\"item\" justify=\"space-between\" align=\"center\">\n        <van-col class=\"check\" :span=\"2\">\n          <van-checkbox v-model=\"state.list[index].checked\" :disabled=\"getError(index).length > 0\" @change=\"onChange(item.id, {status: state.list[index].checked})\"></van-checkbox>\n        </van-col>\n        <van-col class=\"image\" :span=\"6\">\n          <van-image width=\"100%\" height=\"100%\" radius=\"5\" fit=\"contain\" :src=\"item.image\" @click=\"$router.push('item?id=' + item.spu)\"></van-image>\n        </van-col>\n        <van-col class=\"intro\" :span=\"16\">\n          <van-swipe-cell>\n            <template #right>\n              <div class=\"operate\">\n                <van-button square type=\"primary\" text=\"收藏\" @click=\"onRemove(index, item.id, 1)\" />\n                <van-button square type=\"danger\"  text=\"删除\" @click=\"onRemove(index, item.id)\" />\n              </div>\n            </template>\n            <van-cell :border=\"false\" @click=\"$router.push('item?id=' + item.spu)\">\n              <template #title><div class=\"van-multi-ellipsis--l2\">{{item.title}}</div></template>\n              <template #label><div class=\"van-ellipsis\">{{item.spec}}</div></template>\n            </van-cell>\n            <van-cell :border=\"false\" center>\n              <template #title>\n                <span class=\"price\"><span class=\"red\">￥</span> {{item.price}} </span>\n              </template>\n              <van-stepper v-model=\"state.list[index].num\" theme=\"round\" button-size=\"22\" min=\"1\" :max=\"item.stock\" :disabled=\"item.status<0\" integer @change=\"onChange(item.id, {num:state.list[index].num})\" />\n            </van-cell>\n          </van-swipe-cell>\n        </van-col>\n        <div class=\"error\" v-show=\"getError(index).length > 0\">{{getError(index)}}</div>\n      </van-row>\n\n    </van-pull-refresh>\n\n    <van-submit-bar :style=\"{bottom:'50px'}\" :price=\"state.amount*100\" :button-text=\"'去结算(' + state.total + ')'\" @submit=\"onSubmit\">\n      <!-- <template #tip>\n        你的收货地址不支持同城送, <span @click=\"onClickLink\">修改地址</span>\n      </template> -->\n    </van-submit-bar>\n\n  </BaseLayout>\n</template>\n\n<style scoped>\n.extra {\n  width: 100%;\n  background: #EEE;\n  border-radius: 10px 0 0 10px;\n  color: #F30;\n  font-size: 12px;\n}\n\n.list {\n  margin: 0;\n  padding-top: 5px;\n  padding-bottom: 80px;\n  min-height: 500px;\n  background: #F3F3F3;\n  border-radius: 5px;\n}\n\n.item {\n  position: relative;\n  height: 130px;\n  margin: 10px;\n  background: #FFF;\n  border-radius: 5px;\n  text-align: center;\n  overflow: hidden;\n}\n.check {\n  padding-left: 5px;\n}\n.image {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.intro {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: space-between;\n  text-align: left;\n}\n.price {\n  font-size: 16px;\n}\n.red {\n  color: #F00;\n}\n\n.operate {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: space-between;\n}\n.error {\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 3px;\n  background: #CCC;\n  border-radius: 0 0 0 5px;\n  font-size: 9px;\n}\n\n</style>\n\n<script>\nimport {reactive, ref} from 'vue'\nimport {mapState, mapGetters, mapMutations} from 'vuex'\nimport BaseLayout from '@/components/BaseLayout.vue'\n\nexport default {\n  components: {BaseLayout},\n\n  data() {\n    const state = reactive({\n      refreshing: false,\n      list: [],\n      total: 0,\n      amount: 0,\n    });\n    return {state};\n  },\n\n  created() {\n     this.getList();\n  },\n\n  computed: {\n    empty() {\n      return _.isEmpty(this.state.list);\n    },\n    ...mapGetters([\"authorized\"]),\n  },\n\n  methods: {\n    getList() {\n      if (!this.authorized) return;\n\n      this.state.refreshing = true;\n      this.state.list = [];\n\n      this.$http.get(\"/mall/cartlist\").then((data) => {\n        this.state.refreshing = false;\n        for (let i in data){\n          let item = data[i];\n          this.state.list.push({...item, ...{\n            checked: item.status == 1 && item.stock > 0,\n          }});\n        }\n        this.stat();\n      });\n    },\n\n    getError(index) {\n      if (typeof this.state.list[index] != \"object\")\n        return \"\";\n      if (this.state.list[index].status < 0)\n        return \"已下架\";\n      if (this.state.list[index].stock == 0)\n        return \"零库存\";\n      return \"\";\n    },\n\n    stat() {\n      let total = 0;\n      let amount = 0;\n      for (let i in this.state.list){\n        let item = this.state.list[i];\n        if (item.checked){\n          total += parseInt(item.num);\n          amount += parseInt(item.num) * item.price;\n        }\n      }\n      this.state.total = total;\n      this.state.amount = amount;\n      this.cartNumberSet(total);\n    },\n\n    onRemove(index, id, like = 0) {\n      this.$http.post(\"/mall/cartsave?id=\" + id + \"&remove=1&like=\" + like).then(() => {\n        this.state.list = _.omit(this.state.list, index);\n        this.stat();\n      });\n    },\n\n    onChange(id, obj) {\n      typeof obj == \"object\" && this.$http.get(\"/mall/cartsave?id=\" + id + (_.has(obj, \"num\") ? \"&num=\" + obj.num : \"\") + (_.has(obj, \"status\") ? \"&status=\" + (obj.status ? 1 : 0) : \"\") ).then(() => {\n        this.stat();\n      });\n    },\n\n    onSubmit() {\n      if (this.state.total == 0) {\n        return this.$notify(\"请先选择要结算的商品\");\n      }\n      this.$router.push(\"bill\");\n    },\n\n    ...mapMutations([\"cartNumberSet\"]),\n  },\n}\n</script>\n","import { render } from \"./Cart.vue?vue&type=template&id=59f993fe&scoped=true\"\nimport script from \"./Cart.vue?vue&type=script&lang=js\"\nexport * from \"./Cart.vue?vue&type=script&lang=js\"\n\nimport \"./Cart.vue?vue&type=style&index=0&id=59f993fe&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/runner/work/fuli/fuli/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-59f993fe\"]])\n\nexport default __exports__"],"sourceRoot":""}