(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57b22061","chunk-3f3b53e5"],{"13d5":function(t,e,a){"use strict";var n=a("23e7"),i=a("d58f").left,s=a("a640"),r=a("2d00"),c=a("605d"),o=s("reduce"),u=!c&&r>79&&r<83;n({target:"Array",proto:!0,forced:!o||u},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var n=a("1d80"),i=a("5899"),s="["+i+"]",r=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),o=function(t){return function(e){var a=String(n(e));return 1&t&&(a=a.replace(r,"")),2&t&&(a=a.replace(c,"")),a}};t.exports={start:o(1),end:o(2),trim:o(3)}},7156:function(t,e,a){var n=a("861d"),i=a("d2bb");t.exports=function(t,e,a){var s,r;return i&&"function"==typeof(s=e.constructor)&&s!==a&&n(r=s.prototype)&&r!==a.prototype&&i(t,r),t}},"76a1":function(t,e,a){"use strict";a.r(e);var n=a("7a23"),i=Object(n["S"])("data-v-7af5de77");Object(n["B"])("data-v-7af5de77");var s={class:"box"},r={id:"pay",class:"fee"},c={class:"subject"},o=Object(n["i"])(" "),u=Object(n["i"])(" "),l=Object(n["i"])("立即付款"),d=Object(n["i"])("使用微信支付");Object(n["z"])();var h=i((function(t,e,a,h,p,f){var b=Object(n["G"])("van-icon"),j=Object(n["G"])("van-cell"),y=Object(n["G"])("van-switch"),O=Object(n["G"])("van-button"),m=Object(n["G"])("van-action-sheet"),g=Object(n["G"])("BaseLayout");return Object(n["y"])(),Object(n["g"])(g,{title:"收银台",navbar:"hide"},{default:i((function(){return[Object(n["j"])(m,{show:f.popup,"onUpdate:show":e[3]||(e[3]=function(t){return f.popup=t}),title:"收银台","close-on-click-overlay":!1},{default:i((function(){return[Object(n["j"])("div",s,[Object(n["j"])("div",r,[Object(n["j"])(b,{name:"points",size:"20"}),Object(n["i"])(" "+Object(n["K"])(a.fee),1)]),Object(n["j"])("div",c,Object(n["K"])(a.subject),1),Object(n["j"])(j,{title:"订单编号",value:a.oid},null,8,["value"]),Object(n["Q"])(Object(n["j"])(j,{title:"优惠券",value:"无","is-link":""},null,512),[[n["N"],a.tag]]),Object(n["j"])(j,{title:"余额支付",value:"（"+t.profile.cash+" 可用）"},{"right-icon":i((function(){return[o,Object(n["j"])(y,{modelValue:p.state.useCash,"onUpdate:modelValue":e[1]||(e[1]=function(t){return p.state.useCash=t}),size:"24"},null,8,["modelValue"])]})),_:1},8,["value"]),Object(n["j"])(j,{title:"积分支付",value:"（"+t.profile.point+" 可用）"},{"right-icon":i((function(){return[u,Object(n["j"])(y,{modelValue:p.state.usePoint,"onUpdate:modelValue":e[2]||(e[2]=function(t){return p.state.usePoint=t}),size:"24"},null,8,["modelValue"])]})),_:1},8,["value"]),Object(n["j"])(j,{title:"下单时间",value:a.dt},null,8,["value"]),Object(n["j"])(O,{class:"submit",type:"primary",round:"",block:"",onClick:f.handlePay},{default:i((function(){return[l]})),_:1},8,["onClick"]),Object(n["j"])(O,{type:"success",icon:"wechat-pay",round:"",block:"",plain:"",onClick:f.handleWxPay},{default:i((function(){return[d]})),_:1},8,["onClick"])])]})),_:1},8,["show"])]})),_:1})})),p=a("a891"),f=(a("7eed"),a("6b0d")),b=a.n(f);const j=b()(p["a"],[["render",h],["__scopeId","data-v-7af5de77"]]);e["default"]=j},"7eed":function(t,e,a){"use strict";a("b35b")},a36a:function(t,e,a){"use strict";a.r(e);a("b0c0");var n=a("7a23"),i=Object(n["S"])("data-v-d90f81da");Object(n["B"])("data-v-d90f81da");var s={class:"main"};Object(n["z"])();var r=i((function(t,e,a,r,c,o){var u=Object(n["G"])("van-cell"),l=Object(n["G"])("van-card"),d=Object(n["G"])("van-cell-group"),h=Object(n["G"])("van-submit-bar"),p=Object(n["G"])("pay"),f=Object(n["G"])("BaseLayout");return Object(n["y"])(),Object(n["g"])(f,{title:"确认订单"},{default:i((function(){return[Object(n["j"])("div",s,[c.state.addr&&c.state.addr.name?(Object(n["y"])(),Object(n["g"])(u,{key:0,class:"card",size:"large",icon:"location",title:c.state.addr.name+" "+c.state.addr.mobile,label:c.state.addr.province+c.state.addr.city+c.state.addr.county+c.state.addr.address,to:"/my/address/change?target="+o.target,"is-link":"",center:""},null,8,["title","label","to"])):(Object(n["y"])(),Object(n["g"])(u,{key:1,class:"card",size:"large",title:"新增收货地址",to:"/my/address/add?target="+o.target,"is-link":""},null,8,["to"])),(Object(n["y"])(!0),Object(n["g"])(n["a"],null,Object(n["E"])(c.state.list,(function(t,e){return Object(n["y"])(),Object(n["g"])(l,{class:"item",key:e,title:t.title,desc:t.spec,thumb:t.image,price:t.price,num:t.num},null,8,["title","desc","thumb","price","num"])})),128)),Object(n["j"])(d,{class:"fee"},{default:i((function(){return[Object(n["j"])(u,{title:"商品总金额",value:c.state.amount+" 元"},null,8,["value"]),Object(n["j"])(u,{title:"商品总运费",value:c.state.freight+" 元"},null,8,["value"])]})),_:1}),Object(n["j"])(h,{label:"待支付总金额：","button-text":"结算",style:{bottom:"0px"},price:100*o.total,onSubmit:o.buy},null,8,["price","onSubmit"]),Object(n["j"])(p,Object(n["p"])(c.state.payData,{show:c.state.payShow,"onUpdate:show":e[1]||(e[1]=function(t){return c.state.payShow=t}),onOnPayOK:e[2]||(e[2]=function(t){return o.handlePay(!0)}),onOnPayFail:e[3]||(e[3]=function(t){return o.handlePay(!1)})}),null,16,["show"])])]})),_:1})})),c=a("b198"),o=(a("c0d7"),a("6b0d")),u=a.n(o);const l=u()(c["a"],[["render",r],["__scopeId","data-v-d90f81da"]]);e["default"]=l},a891:function(t,e,a){"use strict";(function(t){var n=a("53ca"),i=a("5530"),s=(a("a9e3"),a("7a23")),r=a("5502"),c=a("2824");e["a"]={components:{BaseLayout:c["a"]},name:"Pay",props:{show:{type:Boolean,default:!1},json:{type:String,default:""},oid:{type:[String,Number],default:""},fee:{type:[String,Number],default:0},subject:{type:[String,Number],default:""},tag:{type:[String,Number],default:""},attach:{type:String,default:""},notify:{type:String,default:""},exprie:{type:[String,Number],default:0},dt:{type:String,default:""}},emits:["update:show"],data:function(){var t=Object(s["C"])({useCash:!0,usePoint:!0,type:"",tid:"",pid:""});return{state:t}},created:function(){},computed:Object(i["a"])({popup:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}},Object(r["d"])(["profile"])),methods:Object(i["a"])({handlePay:function(){return this.state.useCash||this.state.usePoint?this.state.useCash&&!this.state.usePoint&&(this.state.type="cash",this.fee>this.profile.cash)?this.$toast("余额不足支付"):!this.state.useCash&&this.state.usePoint&&(this.state.type="point",this.fee>this.profile.point)?this.$toast("积分不足支付"):this.state.useCash&&this.state.usePoint&&(this.state.type="",this.fee>parseFloat(this.profile.point)+parseFloat(this.profile.cash))?this.$toast("账户资产不足，请使用微信支付"):void this.pay():this.$toast("至少选择一种支付方式")},handleWxPay:function(){var t=this;this.$http.post("/wechat/pay?fee="+this.fee+"&name="+this.subject+"&attach="+this.attach).then((function(e){t.state.popup=!1,t.state.pid=e.pid,e.code&&t.$dialog.confirm({title:"请用微信扫码付款",message:"<img src='http://api.qrserver.com/v1/create-qr-code/?size=250x250&ecc=H&margin=10&data="+e.code+"'>",theme:"round-button",confirmButtonText:"我已完成付款",allowHtml:!0}).then(t.wxpayCheck)||WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",e,(function(e){return"get_brand_wcpay_request:ok"!=e.err_msg?t.$dialog.alert({message:"微信支付失败，请重试！"}):t.wxpayCheck()}))}))},wxpayCheck:function(){var e=this;this.popup&&(this.$toast.loading({message:"订单处理中...",forbidClick:!0}),setTimeout((function(){0==document.querySelector("#pay").getBoundingClientRect()["height"]&&(e.popup=!1),e.$http.post("/wechat/payCheck?id="+e.state.pid).then((function(a){return t.isEmpty(a)||Object(n["a"])(a.attach)!=e.attach?e.wxpayCheck():(e.popup=!1,e.state.type="wxpay",e.pay())}))}),5e3))},pay:function(){var t=this;this.$http.post("/pay?order="+this.json+"&type="+this.state.type+"&tid="+this.state.tid+"&pid="+this.state.pid).then((function(){t.$init(),t.$emit("onPayOK")})).catch((function(){t.$emit("onPayFail")}))}},Object(r["c"])(["auth"]))}}).call(this,a("81b0"))},a9e3:function(t,e,a){"use strict";var n=a("83ab"),i=a("da84"),s=a("94ca"),r=a("6eeb"),c=a("5135"),o=a("c6b6"),u=a("7156"),l=a("c04e"),d=a("d039"),h=a("7c73"),p=a("241c").f,f=a("06cf").f,b=a("9bf2").f,j=a("58a8").trim,y="Number",O=i[y],m=O.prototype,g=o(h(m))==y,v=function(t){var e,a,n,i,s,r,c,o,u=l(t,!1);if("string"==typeof u&&u.length>2)if(u=j(u),e=u.charCodeAt(0),43===e||45===e){if(a=u.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+u}for(s=u.slice(2),r=s.length,c=0;c<r;c++)if(o=s.charCodeAt(c),o<48||o>i)return NaN;return parseInt(s,n)}return+u};if(s(y,!O(" 0o1")||!O("0b1")||O("+0x1"))){for(var w,k=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof k&&(g?d((function(){m.valueOf.call(a)})):o(a)!=y)?u(new O(v(e)),a,k):v(e)},S=n?p(O):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),C=0;S.length>C;C++)c(O,w=S[C])&&!c(k,w)&&b(k,w,f(O,w));k.prototype=m,m.constructor=k,r(i,y,k)}},b198:function(t,e,a){"use strict";(function(t){var n=a("5530"),i=(a("13d5"),a("ac1f"),a("1276"),a("7a23")),s=a("5502"),r=a("2824"),c=a("76a1");e["a"]={components:{BaseLayout:r["a"],Pay:c["default"]},data:function(){var t=Object(i["C"])({addr:{},list:[],amount:0,freight:0,useCash:!1,usePoint:!1,payData:{},payShow:!1});return{state:t}},created:function(){var e=this;this.state.addr=this.profile.cartAddress,this.$http.get("/mall/cartlist?channel=1&status=1").then((function(a){e.state.list=a,e.state.amount=t.reduce(e.state.list,(function(e,a,n){return e=t.round(e+a.price*a.num,2),e}),0);var n=t.reduce(e.state.list,(function(t,e,a){return t.push({skuId:e.sku,num:e.num}),t}),[]),i=e.addressCode.split("_");e.$http.get("/jdmall/query?method=order/getFreight&paymentType=4&sku="+JSON.stringify(n)+"&province="+i[0]+"&city="+i[1]+"&county="+i[2]+"&town="+i[3]).then((function(t){e.state.freight=t.freight}))}))},computed:Object(n["a"])(Object(n["a"])({target:function(){return"/jdmall/cart"},total:function(){return this.state.amount+this.state.freight}},Object(s["d"])(["profile"])),Object(s["b"])(["addressCode"])),methods:{buy:function(){var e=this;if(t.isEmpty(this.state.addr))return this.$toast("请先选择收货地址");this.$http.post("/jdmall/checkout?aid="+this.state.addr.id).then((function(t){e.state.payData=Object(n["a"])(Object(n["a"])({},t),{},{json:JSON.stringify(t)}),e.state.payShow=!0}))},handlePay:function(t){var e=this;this.state.payShow=!1,this.$dialog.alert({title:"订单支付"+(t?"成功":"失败"),message:"请在“我的订单”中查看详细情况",theme:"round-button"}).then((function(){e.$router.push("/my/order")}))}}}}).call(this,a("81b0"))},b35b:function(t,e,a){},c0d7:function(t,e,a){"use strict";a("ea13")},d58f:function(t,e,a){var n=a("1c0b"),i=a("7b0b"),s=a("44ad"),r=a("50c4"),c=function(t){return function(e,a,c,o){n(a);var u=i(e),l=s(u),d=r(u.length),h=t?d-1:0,p=t?-1:1;if(c<2)while(1){if(h in l){o=l[h],h+=p;break}if(h+=p,t?h<0:d<=h)throw TypeError("Reduce of empty array with no initial value")}for(;t?h>=0:d>h;h+=p)h in l&&(o=a(o,l[h],h,u));return o}};t.exports={left:c(!1),right:c(!0)}},ea13:function(t,e,a){}}]);