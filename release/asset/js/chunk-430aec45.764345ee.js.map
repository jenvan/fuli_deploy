{"version":3,"sources":["webpack:///./src/views/Mall/Cart.vue","webpack:///./src/views/Mall/Cart.vue?2a68","webpack:///./src/views/Mall/Cart.vue?e34d"],"names":["components","BaseLayout","data","state","refreshing","list","total","amount","created","this","getList","computed","empty","_","isEmpty","methods","authorized","$http","get","then","i","item","push","checked","status","stock","stat","getError","index","parseInt","num","price","cartNumberSet","onRemove","id","like","post","omit","onChange","obj","has","onSubmit","$notify","$router","class","title","subtitle","loading-text","description","type","size","to","key","justify","align","span","disabled","length","width","height","radius","fit","src","image","spu","right","square","text","border","label","spec","center","theme","button-size","min","max","integer","style","button-text","__exports__","render"],"mappings":"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","file":"asset/js/chunk-430aec45.764345ee.js","sourcesContent":["<template>\n  <BaseLayout title=\"购物车\" subtitle=\"更多操作请按住商品标题左滑\">\n\n    <van-pull-refresh class=\"list\" v-model=\"state.refreshing\" loading-text=\" \" @refresh=\"getList\">\n\n      <van-empty v-show=\"empty\" description=\"购物车空空如也 ~\">\n        <van-button v-show=\"!authorized\" type=\"primary\" size=\"small\" to=\"/login\">请先登录</van-button>\n      </van-empty>\n\n      <van-row v-for=\"(item, index) in state.list\" :key=\"index\" class=\"item\" justify=\"space-between\" align=\"center\">\n        <van-col class=\"check\" :span=\"2\">\n          <van-checkbox v-model=\"state.list[index].checked\" :disabled=\"getError(index).length > 0\" @change=\"onChange(item.id, {status: state.list[index].checked})\"></van-checkbox>\n        </van-col>\n        <van-col class=\"image\" :span=\"6\">\n          <van-image width=\"100%\" height=\"100%\" radius=\"5\" fit=\"contain\" :src=\"item.image\" @click=\"$router.push('item?id=' + item.spu)\"></van-image>\n        </van-col>\n        <van-col class=\"intro\" :span=\"16\">\n          <van-swipe-cell>\n            <template #right>\n              <div class=\"operate\">\n                <van-button square type=\"primary\" text=\"收藏\" @click=\"onRemove(index, item.id, 1)\" />\n                <van-button square type=\"danger\"  text=\"删除\" @click=\"onRemove(index, item.id)\" />\n              </div>\n            </template>\n            <van-cell :border=\"false\" @click=\"$router.push('item?id=' + item.spu)\">\n              <template #title><div class=\"van-multi-ellipsis--l2\">{{item.title}}</div></template>\n              <template #label><div class=\"van-ellipsis\">{{item.spec}}</div></template>\n            </van-cell>\n            <van-cell :border=\"false\" center>\n              <template #title>\n                <span class=\"price\"><span class=\"red\">￥</span> {{item.price}} </span>\n              </template>\n              <van-stepper v-model=\"state.list[index].num\" theme=\"round\" button-size=\"22\" min=\"1\" :max=\"item.stock\" :disabled=\"item.status<0\" integer @change=\"onChange(item.id, {num:state.list[index].num})\" />\n            </van-cell>\n          </van-swipe-cell>\n        </van-col>\n        <div class=\"error\" v-show=\"getError(index).length > 0\">{{getError(index)}}</div>\n      </van-row>\n\n    </van-pull-refresh>\n\n    <van-submit-bar :style=\"{bottom:'50px'}\" :price=\"state.amount*100\" :button-text=\"'去结算(' + state.total + ')'\" @submit=\"onSubmit\">\n      <!-- <template #tip>\n        你的收货地址不支持同城送, <span @click=\"onClickLink\">修改地址</span>\n      </template> -->\n    </van-submit-bar>\n\n  </BaseLayout>\n</template>\n\n<style scoped>\n.list {\n  margin: 0;\n  padding-top: 5px;\n  padding-bottom: 80px;\n  min-height: 500px;\n  background: #F3F3F3;\n  border-radius: 5px;\n}\n\n.item {\n  position: relative;\n  height: 130px;\n  margin: 10px;\n  background: #FFF;\n  border-radius: 5px;\n  text-align: center;\n  overflow: hidden;\n}\n.check {\n  padding-left: 5px;\n}\n.image {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.intro {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: space-between;\n  text-align: left;\n}\n.price {\n  font-size: 16px;\n}\n.red {\n  color: #F00;\n}\n\n.operate {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: space-between;\n}\n.error {\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 3px;\n  background: #CCC;\n  border-radius: 0 0 0 5px;\n  font-size: 9px;\n}\n\n</style>\n\n<script>\nimport {reactive, ref} from 'vue'\nimport {mapState, mapGetters, mapMutations} from 'vuex'\nimport BaseLayout from '@/components/BaseLayout.vue'\n\nexport default {\n  components: {BaseLayout},\n\n  data() {\n    const state = reactive({\n      refreshing: false,\n      list: [],\n      total: 0,\n      amount: 0,\n    });\n    return {state};\n  },\n\n  created() {\n     this.getList();\n  },\n\n  computed: {\n    empty() {\n      return _.isEmpty(this.state.list);\n    },\n    ...mapGetters([\"authorized\"]),\n  },\n\n  methods: {\n    getList() {\n      if (!this.authorized) return;\n\n      this.state.refreshing = true;\n      this.state.list = [];\n\n      this.$http.get(\"/mall/cartlist\").then((data) => {\n        this.state.refreshing = false;\n        for (let i in data){\n          let item = data[i];\n          this.state.list.push({...item, ...{\n            checked: item.status == 1 && item.stock > 0,\n          }});\n        }\n        this.stat();\n      });\n    },\n\n    getError(index) {\n      if (typeof this.state.list[index] != \"object\")\n        return \"\";\n      if (this.state.list[index].status < 0)\n        return \"已下架\";\n      if (this.state.list[index].stock == 0)\n        return \"零库存\";\n      return \"\";\n    },\n\n    stat() {\n      let total = 0;\n      let amount = 0;\n      for (let i in this.state.list){\n        let item = this.state.list[i];\n        if (item.checked){\n          total += parseInt(item.num);\n          amount += parseInt(item.num) * item.price;\n        }\n      }\n      this.state.total = total;\n      this.state.amount = amount;\n      this.cartNumberSet(total);\n    },\n\n    onRemove(index, id, like = 0) {\n      this.$http.post(\"/mall/cartsave?id=\" + id + \"&remove=1&like=\" + like).then(() => {\n        this.state.list = _.omit(this.state.list, index);\n        this.stat();\n      });\n    },\n\n    onChange(id, obj) {\n      typeof obj == \"object\" && this.$http.get(\"/mall/cartsave?id=\" + id + (_.has(obj, \"num\") ? \"&num=\" + obj.num : \"\") + (_.has(obj, \"status\") ? \"&status=\" + (obj.status ? 1 : 0) : \"\") ).then(() => {\n        this.stat();\n      });\n    },\n\n    onSubmit() {\n      if (this.state.total == 0) {\n        return this.$notify(\"请先选择要结算的商品\");\n      }\n      this.$router.push(\"bill\");\n    },\n\n    ...mapMutations([\"cartNumberSet\"]),\n  },\n}\n</script>\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Cart.vue?vue&type=style&index=0&id=25ea8baa&scoped=true&lang=css\"","import { render } from \"./Cart.vue?vue&type=template&id=25ea8baa&scoped=true\"\nimport script from \"./Cart.vue?vue&type=script&lang=js\"\nexport * from \"./Cart.vue?vue&type=script&lang=js\"\n\nimport \"./Cart.vue?vue&type=style&index=0&id=25ea8baa&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/runner/work/fuli/fuli/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-25ea8baa\"]])\n\nexport default __exports__"],"sourceRoot":""}