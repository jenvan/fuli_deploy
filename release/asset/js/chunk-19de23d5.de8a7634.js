(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19de23d5","chunk-3f3b53e5"],{"33cc":function(t,e,n){},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("1d80"),c=n("5899"),i="["+c+"]",o=RegExp("^"+i+i+"*"),r=RegExp(i+i+"*$"),s=function(t){return function(e){var n=String(a(e));return 1&t&&(n=n.replace(o,"")),2&t&&(n=n.replace(r,"")),n}};t.exports={start:s(1),end:s(2),trim:s(3)}},"59fd":function(t,e,n){"use strict";n("33cc")},"69fb":function(t,e,n){"use strict";n.r(e);n("b0c0"),n("b64b");var a=n("7a23"),c=Object(a["S"])("data-v-d64c78d2");Object(a["B"])("data-v-d64c78d2");var i=Object(a["i"])("已下单"),o=Object(a["i"])("已付款"),r=Object(a["i"])("已发货"),s=Object(a["i"])("已签收"),u={key:0},l={key:0},d={class:"card"},b={class:"tool"},j=Object(a["i"])(" 复制卡号"),p=Object(a["i"])("   "),h=Object(a["i"])(" 显示卡片"),f={key:1},O={class:"card"},y={class:"tool"},v=Object(a["i"])(" 复制卡密"),g={class:"indicator"},m={class:"van-multi-ellipsis--l2"},k=Object(a["j"])("br",null,null,-1),C=Object(a["i"])("长按图片保存到手机或分享给好友");Object(a["z"])();var w=c((function(t,e,n,w,_,x){var N=Object(a["G"])("van-step"),S=Object(a["G"])("van-steps"),$=Object(a["G"])("van-cell"),G=Object(a["G"])("van-icon"),P=Object(a["G"])("van-swipe-item"),I=Object(a["G"])("van-swipe"),E=Object(a["G"])("van-collapse-item"),K=Object(a["G"])("van-collapse"),F=Object(a["G"])("van-divider"),V=Object(a["G"])("van-action-bar-icon"),L=Object(a["G"])("van-action-bar-button"),B=Object(a["G"])("van-action-bar"),A=Object(a["G"])("van-image"),T=Object(a["G"])("van-popup"),U=Object(a["G"])("pay"),z=Object(a["G"])("BaseLayout");return Object(a["y"])(),Object(a["g"])(z,{title:"订单详情"},{default:c((function(){return[Object(a["Q"])(Object(a["j"])(S,{class:"step",active:w.status},{default:c((function(){return[Object(a["j"])(N,null,{default:c((function(){return[i]})),_:1}),Object(a["j"])(N,null,{default:c((function(){return[o]})),_:1}),Object(a["j"])(N,null,{default:c((function(){return[r]})),_:1}),Object(a["j"])(N,null,{default:c((function(){return[s]})),_:1})]})),_:1},8,["active"]),[[a["N"],w.status<4]]),Object(a["j"])(K,{class:"bill",modelValue:w.unfold,"onUpdate:modelValue":e[1]||(e[1]=function(t){return w.unfold=t})},{default:c((function(){return[Object(a["j"])(E,{name:"0",title:"收货信息",value:0==w.state.order.card?"物流派送":w.state.order.card<0?"电子卡密":"提货卡"},{default:c((function(){return[0==w.state.order.card?(Object(a["y"])(),Object(a["g"])("div",u,[Object(a["j"])($,null,{title:c((function(){return[Object(a["i"])(Object(a["K"])(w.state.order.consignee.name)+"（"+Object(a["K"])(w.state.order.consignee.mobile)+"）",1)]})),label:c((function(){return[Object(a["i"])(Object(a["K"])(w.state.order.consignee.province)+" "+Object(a["K"])(w.state.order.consignee.city)+" "+Object(a["K"])(w.state.order.consignee.county)+" "+Object(a["K"])(w.state.order.consignee.address),1)]})),_:1}),(Object(a["y"])(!0),Object(a["g"])(a["a"],null,Object(a["E"])(w.state.order.logistics,(function(e,c,i){return Object(a["y"])(),Object(a["g"])($,{key:c,title:e.dt+(Object.keys(w.state.order.logistics).length>1?"（包裹 "+(i+1)+"）":""),label:e.msg,border:"","is-link":"",onClick:function(e){return t.$router.push("/my/order/track?id="+n.id+"&lid="+c)}},null,8,["title","label","onClick"])})),128))])):(Object(a["y"])(),Object(a["g"])(I,{key:1,class:"swipe"},{indicator:c((function(t){var e=t.active;return[Object(a["j"])("div",g,Object(a["K"])(e+1)+" / "+Object(a["K"])(w.state.cards.length),1)]})),default:c((function(){return[(Object(a["y"])(!0),Object(a["g"])(a["a"],null,Object(a["E"])(w.state.cards,(function(e,n){return Object(a["y"])(),Object(a["g"])(P,{key:n,style:{background:e.bg}},{default:c((function(){return[w.state.order.card>0?(Object(a["y"])(),Object(a["g"])("div",l,[Object(a["j"])("div",d,"提货卡号：****"+Object(a["K"])(e.token.substr(4)),1),Object(a["j"])("div",b,[Object(a["j"])(G,{name:"more-o",onClick:function(t){return x.onFinish()&x.copy(e.token)}},{default:c((function(){return[j]})),_:2},1032,["onClick"]),p,Object(a["j"])(G,{name:"photo-o",onClick:function(t){return x.onFinish()&x.save(e.token)}},{default:c((function(){return[h]})),_:2},1032,["onClick"])])])):Object(a["h"])("",!0),w.state.order.card<0?(Object(a["y"])(),Object(a["g"])("div",f,[Object(a["j"])("div",O,Object(a["K"])(e.no),1),Object(a["j"])("div",y,[Object(a["Q"])(Object(a["j"])(G,{name:"more-o",onClick:function(n){return x.onFinish()&t.$copy(e.no+"\n"+e.pwd)}},{default:c((function(){return[v]})),_:2},1032,["onClick"]),[[a["N"],e.pwd&&e.pwd.length>0]])]),Object(a["Q"])(Object(a["j"])("div",{class:"deadline"}," 有效期至："+Object(a["K"])(e.deadline),513),[[a["N"],e.deadline&&e.deadline.length>0]])])):Object(a["h"])("",!0)]})),_:2},1032,["style"])})),128))]})),_:1}))]})),_:1},8,["value"]),Object(a["j"])(E,{name:"1",title:"商品信息",value:"共 "+(w.state.order.card<=0?w.state.order.total:w.state.order.card+" x "+w.state.order.total/w.state.order.card)+" 件"},{default:c((function(){return[(Object(a["y"])(!0),Object(a["g"])(a["a"],null,Object(a["E"])(w.state.order.detail,(function(t,e){return Object(a["y"])(),Object(a["g"])($,{key:e,label:t.spec,style:{alignItems:"center"},onClick:function(e){return x.onView(t)}},{icon:c((function(){return[Object(a["j"])(G,{class:"img",name:t.image,size:"32"},null,8,["name"])]})),title:c((function(){return[Object(a["j"])("div",m,Object(a["K"])(t.title),1)]})),extra:c((function(){return[Object(a["i"])(" x"+Object(a["K"])(t.num),1)]})),_:2},1032,["label","onClick"])})),128))]})),_:1},8,["value"]),Object(a["j"])(E,{name:"2",title:"订单总额",value:w.state.order.amount+" 元"},{default:c((function(){return[Object(a["j"])($,{title:"实付积分",value:w.state.order.point+" 分"},null,8,["value"]),Object(a["j"])($,{title:"实付现金",value:w.state.order.cash+" 元"},null,8,["value"])]})),_:1},8,["value"]),Object(a["j"])(E,{name:"3",title:"交易状态"},{value:c((function(){return[Object(a["j"])("div",{style:{color:w.state.order.color}},Object(a["K"])(w.state.order.result),5)]})),default:c((function(){return[Object(a["j"])($,{title:"创建时间",value:w.state.order.dt_create},null,8,["value"]),Object(a["j"])($,{title:"付款时间",value:w.state.order.dt_pay},null,8,["value"]),Object(a["j"])($,{title:"发货时间",value:w.state.order.dt_send},null,8,["value"]),Object(a["j"])($,{title:"完成时间",value:w.state.order.dt_finish},null,8,["value"])]})),_:1})]})),_:1},8,["modelValue"]),Object(a["j"])(F,{style:{color:"#EEE"},onClick:e[2]||(e[2]=function(e){return t.$copy(n.id+" "+w.state.order.extra)})},{default:c((function(){return[Object(a["i"])("# "+Object(a["K"])(n.id)+" # "+Object(a["K"])(w.state.order.extra),1)]})),_:1}),Object(a["j"])(B,null,{default:c((function(){return[Object(a["j"])(V,{icon:"chat-o",text:"客服",onClick:e[3]||(e[3]=function(t){return w.state.popup2=!0})}),0==w.state.order.status?(Object(a["y"])(),Object(a["g"])(L,{key:0,type:"warning",text:"关闭订单",onClick:x.onClose},null,8,["onClick"])):Object(a["h"])("",!0),0==w.state.order.status?(Object(a["y"])(),Object(a["g"])(L,{key:1,type:"primary",text:"立即付款",onClick:x.onPay},null,8,["onClick"])):Object(a["h"])("",!0),0==w.state.order.card&&2==w.state.order.status?(Object(a["y"])(),Object(a["g"])(L,{key:2,type:"success",text:"确认收货",onClick:x.onFinish},null,8,["onClick"])):Object(a["h"])("",!0),0==w.state.order.card&&w.state.order.status>0?(Object(a["y"])(),Object(a["g"])(L,{key:3,type:"danger",text:"申请售后",onClick:x.onService},null,8,["onClick"])):Object(a["h"])("",!0)]})),_:1}),Object(a["j"])(T,{show:w.state.popup1,"onUpdate:show":e[4]||(e[4]=function(t){return w.state.popup1=t})},{default:c((function(){return[Object(a["j"])(A,{class:"giftcard",src:w.state.giftcard,width:"300"},{default:c((function(){return[k,C]})),_:1},8,["src"])]})),_:1},8,["show"]),Object(a["j"])(T,{show:w.state.popup2,"onUpdate:show":e[5]||(e[5]=function(t){return w.state.popup2=t}),position:"top",style:{height:"50%",padding:"20px"}},{default:c((function(){return[Object(a["j"])("div",{class:"contact",innerHTML:t.config.contact},null,8,["innerHTML"])]})),_:1},8,["show"]),Object(a["j"])(U,Object(a["p"])(w.state.payData,{show:w.state.payShow,"onUpdate:show":e[6]||(e[6]=function(t){return w.state.payShow=t}),onOnPayOK:e[7]||(e[7]=function(t){return x.handlePay(!0)}),onOnPayFail:e[8]||(e[8]=function(t){return x.handlePay(!1)})}),null,16,["show"])]})),_:1})})),_=n("b1c2"),x=(n("59fd"),n("6b0d")),N=n.n(x);const S=N()(_["a"],[["render",w],["__scopeId","data-v-d64c78d2"]]);e["default"]=S},7156:function(t,e,n){var a=n("861d"),c=n("d2bb");t.exports=function(t,e,n){var i,o;return c&&"function"==typeof(i=e.constructor)&&i!==n&&a(o=i.prototype)&&o!==n.prototype&&c(t,o),t}},"76a1":function(t,e,n){"use strict";n.r(e);var a=n("7a23"),c=Object(a["S"])("data-v-7af5de77");Object(a["B"])("data-v-7af5de77");var i={class:"box"},o={id:"pay",class:"fee"},r={class:"subject"},s=Object(a["i"])(" "),u=Object(a["i"])(" "),l=Object(a["i"])("立即付款"),d=Object(a["i"])("使用微信支付");Object(a["z"])();var b=c((function(t,e,n,b,j,p){var h=Object(a["G"])("van-icon"),f=Object(a["G"])("van-cell"),O=Object(a["G"])("van-switch"),y=Object(a["G"])("van-button"),v=Object(a["G"])("van-action-sheet"),g=Object(a["G"])("BaseLayout");return Object(a["y"])(),Object(a["g"])(g,{title:"收银台",navbar:"hide"},{default:c((function(){return[Object(a["j"])(v,{show:p.popup,"onUpdate:show":e[3]||(e[3]=function(t){return p.popup=t}),title:"收银台","close-on-click-overlay":!1},{default:c((function(){return[Object(a["j"])("div",i,[Object(a["j"])("div",o,[Object(a["j"])(h,{name:"points",size:"20"}),Object(a["i"])(" "+Object(a["K"])(n.fee),1)]),Object(a["j"])("div",r,Object(a["K"])(n.subject),1),Object(a["j"])(f,{title:"订单编号",value:n.oid},null,8,["value"]),Object(a["Q"])(Object(a["j"])(f,{title:"优惠券",value:"无","is-link":""},null,512),[[a["N"],n.tag]]),Object(a["j"])(f,{title:"余额支付",value:"（"+t.profile.cash+" 可用）"},{"right-icon":c((function(){return[s,Object(a["j"])(O,{modelValue:j.state.useCash,"onUpdate:modelValue":e[1]||(e[1]=function(t){return j.state.useCash=t}),size:"24"},null,8,["modelValue"])]})),_:1},8,["value"]),Object(a["j"])(f,{title:"积分支付",value:"（"+t.profile.point+" 可用）"},{"right-icon":c((function(){return[u,Object(a["j"])(O,{modelValue:j.state.usePoint,"onUpdate:modelValue":e[2]||(e[2]=function(t){return j.state.usePoint=t}),size:"24"},null,8,["modelValue"])]})),_:1},8,["value"]),Object(a["j"])(f,{title:"下单时间",value:n.dt},null,8,["value"]),Object(a["j"])(y,{class:"submit",type:"primary",round:"",block:"",onClick:p.handlePay},{default:c((function(){return[l]})),_:1},8,["onClick"]),Object(a["j"])(y,{type:"success",icon:"wechat-pay",round:"",block:"",plain:"",onClick:p.handleWxPay},{default:c((function(){return[d]})),_:1},8,["onClick"])])]})),_:1},8,["show"])]})),_:1})})),j=n("a891"),p=(n("7eed"),n("6b0d")),h=n.n(p);const f=h()(j["a"],[["render",b],["__scopeId","data-v-7af5de77"]]);e["default"]=f},"7eed":function(t,e,n){"use strict";n("b35b")},a891:function(t,e,n){"use strict";(function(t){var a=n("53ca"),c=n("5530"),i=(n("a9e3"),n("7a23")),o=n("5502"),r=n("2824");e["a"]={components:{BaseLayout:r["a"]},name:"Pay",props:{show:{type:Boolean,default:!1},json:{type:String,default:""},oid:{type:[String,Number],default:""},fee:{type:[String,Number],default:0},subject:{type:[String,Number],default:""},tag:{type:[String,Number],default:""},attach:{type:String,default:""},notify:{type:String,default:""},exprie:{type:[String,Number],default:0},dt:{type:String,default:""}},emits:["update:show"],data:function(){var t=Object(i["C"])({useCash:!0,usePoint:!0,type:"",tid:"",pid:""});return{state:t}},created:function(){},computed:Object(c["a"])({popup:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}},Object(o["d"])(["profile"])),methods:Object(c["a"])({handlePay:function(){return this.state.useCash||this.state.usePoint?this.state.useCash&&!this.state.usePoint&&(this.state.type="cash",this.fee>this.profile.cash)?this.$toast("余额不足支付"):!this.state.useCash&&this.state.usePoint&&(this.state.type="point",this.fee>this.profile.point)?this.$toast("积分不足支付"):this.state.useCash&&this.state.usePoint&&(this.state.type="",this.fee>parseFloat(this.profile.point)+parseFloat(this.profile.cash))?this.$toast("账户资产不足，请使用微信支付"):void this.pay():this.$toast("至少选择一种支付方式")},handleWxPay:function(){var t=this;this.$http.post("/wechat/pay?fee="+this.fee+"&name="+this.subject+"&attach="+this.attach).then((function(e){t.state.popup=!1,t.state.pid=e.pid,e.code&&t.$dialog.confirm({title:"请用微信扫码付款",message:"<img src='http://api.qrserver.com/v1/create-qr-code/?size=250x250&ecc=H&margin=10&data="+e.code+"'>",theme:"round-button",confirmButtonText:"我已完成付款",allowHtml:!0}).then(t.wxpayCheck)||WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",e,(function(e){return"get_brand_wcpay_request:ok"!=e.err_msg?t.$dialog.alert({message:"微信支付失败，请重试！"}):t.wxpayCheck()}))}))},wxpayCheck:function(){var e=this;this.popup&&(this.$toast.loading({message:"订单处理中...",forbidClick:!0}),setTimeout((function(){0==document.querySelector("#pay").getBoundingClientRect()["height"]&&(e.popup=!1),e.$http.post("/wechat/payCheck?id="+e.state.pid).then((function(n){return t.isEmpty(n)||Object(a["a"])(n.attach)!=e.attach?e.wxpayCheck():(e.popup=!1,e.state.type="wxpay",e.pay())}))}),5e3))},pay:function(){var t=this;this.$http.post("/pay?order="+this.json+"&type="+this.state.type+"&tid="+this.state.tid+"&pid="+this.state.pid).then((function(){t.$init(),t.$emit("onPayOK")})).catch((function(){t.$emit("onPayFail")}))}},Object(o["c"])(["auth"]))}}).call(this,n("81b0"))},a9e3:function(t,e,n){"use strict";var a=n("83ab"),c=n("da84"),i=n("94ca"),o=n("6eeb"),r=n("5135"),s=n("c6b6"),u=n("7156"),l=n("c04e"),d=n("d039"),b=n("7c73"),j=n("241c").f,p=n("06cf").f,h=n("9bf2").f,f=n("58a8").trim,O="Number",y=c[O],v=y.prototype,g=s(b(v))==O,m=function(t){var e,n,a,c,i,o,r,s,u=l(t,!1);if("string"==typeof u&&u.length>2)if(u=f(u),e=u.charCodeAt(0),43===e||45===e){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:a=2,c=49;break;case 79:case 111:a=8,c=55;break;default:return+u}for(i=u.slice(2),o=i.length,r=0;r<o;r++)if(s=i.charCodeAt(r),s<48||s>c)return NaN;return parseInt(i,a)}return+u};if(i(O,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var k,C=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof C&&(g?d((function(){v.valueOf.call(n)})):s(n)!=O)?u(new y(m(e)),n,C):m(e)},w=a?j(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),_=0;w.length>_;_++)r(y,k=w[_])&&!r(C,k)&&h(C,k,p(y,k));C.prototype=v,v.constructor=C,o(c,O,C)}},b1c2:function(t,e,n){"use strict";(function(t){var a=n("5530"),c=(n("a9e3"),n("7a23")),i=n("5502"),o=n("2824"),r=n("76a1");e["a"]={components:{BaseLayout:o["a"],Pay:r["default"]},props:{id:{type:[String,Number],default:0}},setup:function(){var t=Object(c["C"])({order:{},cards:[],popup1:!1,giftcard:"",popup2:!1,payData:{},payShow:!1}),e=Object(c["D"])(0),n=Object(c["D"])(["0","1"]),a=Object(c["D"])(0);return{state:t,status:e,unfold:n,active:a}},created:function(){this.onLoad()},computed:Object(a["a"])({},Object(i["d"])(["channel","config"])),methods:{onLoad:function(){var e=this;this.state.cards=[],this.$http.post("/mall/orderDetail?id="+this.id).then((function(n){if(e.state.order=n,e.state.order.color=["#CCC","#666","#00C","#0C0","#C00"][n.status],e.state.order.result=["未付款","已付款","已发货","交易成功","交易关闭"][n.status],e.status=n.status,0!=n.card){for(var a in n.cards)n.cards[a].bg="rgb("+t.random(150,250)+","+t.random(150,250)+","+t.random(150,250)+")";e.state.cards=n.cards}n.channel>0&&n.status>0&&e.$http.get("/"+e.channel[n.channel]["type"]+"/orderUpdate?id="+e.id)}))},onView:function(t){var e="/mall/item?id="+t.spu;this.state.order.channel>0&&(e="/"+this.channel[this.state.order.channel]["type"]+"/item?id="+t.sku),this.$router.push(e)},onPay:function(){var t=this,e="/mall/pay";this.state.order.channel>0&&(e="/"+this.channel[this.state.order.channel]["type"]+"/pay"),this.$http.post(e+"?oid="+this.id).then((function(e){t.state.payData=Object(a["a"])(Object(a["a"])({},e),{},{json:JSON.stringify(e)}),t.state.payShow=!0}))},onClose:function(){0==this.state.order.status&&this.$http.post("/mall/orderClose?id="+this.id).then(this.onLoad)},onFinish:function(){2==this.state.order.status&&this.$http.post("/mall/orderFinish?id="+this.id).then(this.onLoad)},onService:function(){this.$router.push("/my/service?id="+this.id)},handlePay:function(t){this.state.payShow=!1,this.$dialog.alert({message:"订单支付"+(t?"成功":"失败"),theme:"round-button"}).then(this.onLoad)},copy:function(t){var e="提货卡号："+t+"（请关注微信公众号“福鲤社”，点击下方菜单提货）";this.$copy(e)},save:function(t){this.state.popup1=!0,this.state.giftcard=this.$host+"/mall/card?type=pick&token="+t}}}}).call(this,n("81b0"))},b35b:function(t,e,n){}}]);