(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-023439ca"],{"9a90":function(t,e,a){},a379:function(t,e,a){"use strict";a.r(e);a("fb6a"),a("d3b7"),a("25f0");var n=a("7a23"),s=Object(n["X"])("data-v-6d60c892");Object(n["D"])("data-v-6d60c892");var o={class:"panel"},r=Object(n["k"])("div",{class:"subject"},"金额",-1),c={class:"panel"},i=Object(n["k"])("div",{class:"stripe"},null,-1);Object(n["B"])();var l=s((function(t,e,a,l,u,h){var d=Object(n["I"])("van-icon"),b=Object(n["I"])("van-cell"),f=Object(n["I"])("van-field"),p=Object(n["I"])("van-number-keyboard"),m=Object(n["I"])("pay",!0),O=Object(n["I"])("BaseLayout");return Object(n["A"])(),Object(n["g"])(O,{title:h.title,bg:"#F6F6F6",fg:"#000",navbar:"hide"},{default:s((function(){return[Object(n["k"])(b,{class:"user",title:"向"+(u.state.user.merchant?"商户":"个人")+h.title,border:!1,label:u.state.user.nickname,onClick:h.handleManage},{extra:s((function(){return[Object(n["k"])(d,{class:"avatar",name:u.state.user.avatar||"manager",size:"48",color:"#"+Math.random().toString(16).slice(-6)},null,8,["name","color"])]})),_:1},8,["title","label","onClick"]),Object(n["U"])(Object(n["k"])("div",o,[r,Object(n["k"])(f,{class:"amount",type:"number",modelValue:u.state.amount,"onUpdate:modelValue":e[1]||(e[1]=function(t){return u.state.amount=t}),label:"￥",formatter:h.formarter,readonly:""},null,8,["modelValue","formatter"]),Object(n["k"])(p,{modelValue:u.state.amount,"onUpdate:modelValue":e[2]||(e[2]=function(t){return u.state.amount=t}),show:!0,theme:"custom","extra-key":".",maxlength:"6","close-button-text":h.title,"safe-area-inset-bottom":!1,"blur-on-close":!1,onClose:h.handlePay},null,8,["modelValue","close-button-text","onClose"])],512),[[n["Q"],!u.state.resultShow]]),Object(n["U"])(Object(n["k"])("div",c,[i,Object(n["k"])("div",{class:"result",style:{borderColor:u.state.resultColor}},[Object(n["k"])("div",{class:"title",style:{color:u.state.resultColor}},Object(n["M"])(u.state.resultTitle),5),Object(n["k"])("div",{class:"info",innerHTML:u.state.resultInfo},null,8,["innerHTML"]),Object(n["k"])("div",{class:"link",onClick:e[3]||(e[3]=function(e){return t.$router.push("/my/point")})},Object(n["M"])(u.state.resultLink),1),Object(n["k"])(d,{class:"icon",name:u.state.resultIcon,color:u.state.resultColor},null,8,["name","color"])],4)],512),[[n["Q"],u.state.resultShow]]),Object(n["k"])(m,Object(n["r"])({show:u.state.payShow,"onUpdate:show":e[4]||(e[4]=function(t){return u.state.payShow=t})},u.state.payData,{onOnFinish:h.handlePayResult}),null,16,["show","onOnFinish"]),Object(n["U"])(Object(n["k"])("div",{class:"watermark",innerHTML:a.code+"<br>"+t.uid+"<br>"+u.now},null,8,["innerHTML"]),[[n["Q"],u.state.resultShow]])]})),_:1},8,["title"])})),u=a("5530"),h=(a("ac1f"),a("5319"),a("5502")),d=a("2824"),b=a("a6e6"),f={components:{BaseLayout:d["a"],Pay:b["default"]},props:{code:{type:String,default:""}},data:function(){var t=Object(n["E"])({user:{},amount:"",payData:{},payShow:!1,resultShow:!1,resultColor:"",resultIcon:"",resultTitle:"",resultInfo:"",resultLink:""}),e=(Object(n["F"])(null),Object(n["F"])(""));return{state:t,now:e}},created:function(){var t=this,e=this.payin?"scanpay?action=user&code=":"pay?code=";this.$http.post("/o2o/"+e+this.code).then((function(e){t.state.user=e}))},mounted:function(){var t=this;this.toggleChat(!1),this.timer=setInterval((function(){var e=new Date;t.now=(e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()).replace(/([-: ])(\d{1})(?!\d)/g,"$10$2")}),1e3)},unmounted:function(){this.toggleChat(!0),clearInterval(this.timer)},computed:Object(u["a"])(Object(u["a"])({payin:function(){return/^\d{10,}$/.test(this.code)},title:function(){return this.payin?"收款":"付款"}},Object(h["d"])(["profile"])),Object(h["b"])(["uid"])),methods:Object(u["a"])({formarter:function(t){return t?t.toString().replace(/\.(\d\d).+/,".$1"):""},handleManage:function(){8!=this.code.length||this.uid>1e4||(this.$copy(this.code),this.$router.push("biz?code="+this.code))},handlePay:function(){var t=this;if(!this.state.payShow){var e=parseFloat(this.state.amount);if(isNaN(e))return this.$toast("请输入"+this.title+"金额");var a=this.state.user.merchant||this.payin?.1:2;if(e<a||e>=1e3)return this.$toast(this.title+"金额最小"+a+"元、最大1000元");this.state.amount=e.toString(),this.payin?this.$http.post("/o2o/scanpay?code="+this.code+"&fee="+this.state.amount).then((function(e){t.handlePayResult(!0,e)})).catch((function(e){t.handlePayResult(!1,e.msg)})):this.$http.post("/o2o/pay?code="+this.code+"&amount="+this.state.amount).then((function(e){t.state.payData=Object(u["a"])(Object(u["a"])({},e),{},{json:JSON.stringify(e)}),t.state.payShow=!0}))}},handlePayResult:function(t,e){var a="交易时间："+this.now;e&&(e.oid&&(a+="<br>交易流水："+e.oid),e.fee&&(a+="<br>交易金额：￥"+e.fee),e.charge&&(a+="<br>实付金额：￥"+e.charge)),this.state.resultShow=!0,this.state.resultColor=t?"#6C0":"#C00",this.state.resultIcon=t?"checked":"close",this.state.resultTitle=this.title+(t?e&&e.fee?" "+e.fee+" 元":"成功":"失败"),this.state.resultInfo=t?a:e,this.state.resultLink=t?"交易详情 >>>":""}},Object(h["c"])(["toggleChat"]))},p=(a("a57c"),a("d959")),m=a.n(p);const O=m()(f,[["render",l],["__scopeId","data-v-6d60c892"]]);e["default"]=O},a57c:function(t,e,a){"use strict";a("9a90")},fb6a:function(t,e,a){"use strict";var n=a("23e7"),s=a("861d"),o=a("e8b5"),r=a("23cb"),c=a("50c4"),i=a("fc6a"),l=a("8418"),u=a("b622"),h=a("1dde"),d=h("slice"),b=u("species"),f=[].slice,p=Math.max;n({target:"Array",proto:!0,forced:!d},{slice:function(t,e){var a,n,u,h=i(this),d=c(h.length),m=r(t,d),O=r(void 0===e?d:e,d);if(o(h)&&(a=h.constructor,"function"!=typeof a||a!==Array&&!o(a.prototype)?s(a)&&(a=a[b],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return f.call(h,m,O);for(n=new(void 0===a?Array:a)(p(O-m,0)),u=0;m<O;m++,u++)m in h&&l(n,u,h[m]);return n.length=u,n}})}}]);