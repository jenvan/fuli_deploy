(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f420e14"],{"290c":function(t,e,n){},"857a":function(t,e,n){var c=n("1d80"),a=/"/g;t.exports=function(t,e,n,i){var o=String(c(t)),u="<"+e;return""!==n&&(u+=" "+n+'="'+String(i).replace(a,"&quot;")+'"'),u+">"+o+"</"+e+">"}},9632:function(t,e,n){"use strict";n("290c")},9911:function(t,e,n){"use strict";var c=n("23e7"),a=n("857a"),i=n("af03");c({target:"String",proto:!0,forced:i("link")},{link:function(t){return a(this,"a","href",t)}})},af03:function(t,e,n){var c=n("d039");t.exports=function(t){return c((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},dab8:function(t,e,n){"use strict";n.r(e);n("d3b7"),n("25f0"),n("caad"),n("2532");var c=n("7a23"),a=Object(c["X"])("data-v-dc22f0c6");Object(c["D"])("data-v-dc22f0c6");var i=Object(c["j"])("会销宝"),o={class:"range"},u=Object(c["k"])("br",null,null,-1),s={class:"tool"},r=Object(c["j"])(" 统计"),l=Object(c["j"])("    "),d=Object(c["j"])(" 分享"),f=Object(c["j"])("    "),b=Object(c["j"])(" 派发"),p=Object(c["j"])("暂无领取记录"),h={class:"popup"},j=Object(c["k"])("p",null,"分享优惠券",-1),O=Object(c["j"])("长按图片保存到手机或转发分享给客户"),k={class:"popup"},g=Object(c["j"])("立即派发");Object(c["B"])();var v=a((function(t,e,n,v,m,w){var C=Object(c["I"])("van-button"),_=Object(c["I"])("van-tab"),y=Object(c["I"])("van-tabs"),I=Object(c["I"])("van-sticky"),x=Object(c["I"])("van-tag"),M=Object(c["I"])("van-cell"),U=Object(c["I"])("van-icon"),F=Object(c["I"])("van-cell-group"),L=Object(c["I"])("van-empty"),S=Object(c["I"])("van-list"),V=Object(c["I"])("van-pull-refresh"),R=Object(c["I"])("van-action-bar-button"),$=Object(c["I"])("van-action-bar"),A=Object(c["I"])("van-action-sheet"),E=Object(c["I"])("van-code"),q=Object(c["I"])("van-popup"),G=Object(c["I"])("van-field"),H=Object(c["I"])("member"),Q=Object(c["I"])("BaseLayout");return Object(c["A"])(),Object(c["g"])(Q,{title:"优惠券"},{extra:a((function(){return[Object(c["k"])(C,{icon:"fire",style:{width:"110px",borderRadius:"10px 0 0 10px",color:"#000"},color:"#F6F6F6",onClick:w.onClick},{default:a((function(){return[i]})),_:1},8,["onClick"])]})),default:a((function(){return[Object(c["k"])(I,{"offset-top":45},{default:a((function(){return[Object(c["k"])(y,{active:v.active,"onUpdate:active":e[1]||(e[1]=function(t){return v.active=t}),swipeable:"",animated:"",onChange:w.onChange},{default:a((function(){return[(Object(c["A"])(),Object(c["g"])(c["a"],null,Object(c["G"])(["有效的优惠券","已失效优惠券"],(function(t,e){return Object(c["k"])(_,{key:e,name:e.toString(),title:t},null,8,["name","title"])})),64))]})),_:1},8,["active","onChange"])]})),_:1}),Object(c["k"])(V,{modelValue:v.state.refreshing,"onUpdate:modelValue":e[3]||(e[3]=function(t){return v.state.refreshing=t}),onRefresh:w.onRefresh},{default:a((function(){return[Object(c["k"])(S,{class:"list",loading:v.state.loading,"onUpdate:loading":e[2]||(e[2]=function(t){return v.state.loading=t}),finished:v.state.finished,"loading-text":"正在请求数据 ...","finished-text":"没有更多了","immediate-check":!1,onLoad:w.onLoad},{default:a((function(){return[(Object(c["A"])(!0),Object(c["g"])(c["a"],null,Object(c["G"])(v.state.list,(function(t,e){return Object(c["A"])(),Object(c["g"])("div",{key:e},[Object(c["k"])(x,{class:"dt",color:"#EEE"},{default:a((function(){return[Object(c["j"])(Object(c["M"])(t.dt),1)]})),_:2},1024),Object(c["k"])(F,{class:{item:!0,selected:v.state.pack.includes(t.id)},border:!1},{default:a((function(){return[Object(c["k"])(M,{class:"title",title:t.coupon.title,onClick:function(e){return w.onChoose(t.id)}},{icon:a((function(){return[Object(c["k"])("div",{class:"value",style:{color:t.color},innerHTML:t.title},null,12,["innerHTML"])]})),label:a((function(){return[Object(c["k"])("div",o,[Object(c["j"])(" 券有效期："+Object(c["M"])(t.coupon.dt_start.substring(0,10))+" ~ "+Object(c["M"])(t.coupon.dt_end.substring(0,10))+" ",1),u,Object(c["j"])(" 派发期限："+Object(c["M"])(t.dt_start.substring(0,10))+" ~ "+Object(c["M"])(t.dt_end.substring(0,10)),1)])]})),_:2},1032,["title","onClick"]),Object(c["k"])(M,{class:"desc",title:"总数："+t.total+"   剩余："+t.surplus},{value:a((function(){return[Object(c["U"])(Object(c["k"])("div",s,[Object(c["k"])(U,{name:"chart-trending-o",size:"12",onClick:Object(c["W"])((function(e){return w.onView(t.id)}),["stop"])},{default:a((function(){return[r]})),_:2},1032,["onClick"]),l,Object(c["k"])(U,{name:"share-o",size:"12",onClick:Object(c["W"])((function(e){v.state.cid=t.id,w.onShare()}),["stop"])},{default:a((function(){return[d]})),_:2},1032,["onClick"]),f,Object(c["k"])(U,{name:"gift-o",size:"12",onClick:Object(c["W"])((function(e){v.state.cid=t.id,v.state.account="",v.state.popup2=!0}),["stop"])},{default:a((function(){return[b]})),_:2},1032,["onClick"])],512),[[c["Q"],0==n.invalid]])]})),_:2},1032,["title"])]})),_:2},1032,["class"])])})),128)),Object(c["U"])(Object(c["k"])(L,{style:{width:"100%"}},null,512),[[c["Q"],0==v.state.list.length]])]})),_:1},8,["loading","finished","onLoad"])]})),_:1},8,["modelValue","onRefresh"]),Object(c["U"])(Object(c["k"])($,null,{default:a((function(){return[Object(c["k"])(R,{type:"primary",text:"分享选中的优惠券",onClick:w.onShare},null,8,["onClick"])]})),_:1},512),[[c["Q"],v.state.pack.length>0]]),Object(c["k"])(A,{show:v.state.popup,"onUpdate:show":e[4]||(e[4]=function(t){return v.state.popup=t}),title:"优惠券领取记录",style:{height:"100%",maxHeight:"80%",background:"#F6F6F6"}},{default:a((function(){return[(Object(c["A"])(!0),Object(c["g"])(c["a"],null,Object(c["G"])(v.state.detail,(function(t,e){return Object(c["A"])(),Object(c["g"])("div",{class:"popup",key:e},[Object(c["k"])(M,{title:t.dt,value:"#"+t.gainer},null,8,["title","value"])])})),128)),Object(c["U"])(Object(c["k"])(L,{style:{width:"100%"}},{default:a((function(){return[p]})),_:1},512),[[c["Q"],0==v.state.detail.length]])]})),_:1},8,["show"]),Object(c["k"])(q,{show:v.state.popup1,"onUpdate:show":e[5]||(e[5]=function(t){return v.state.popup1=t}),round:""},{default:a((function(){return[Object(c["k"])("div",h,[j,Object(c["k"])(E,{type:"qrimage",value:v.state.qrcode,width:"300",margin:"0"},{default:a((function(){return[O]})),_:1},8,["value"])])]})),_:1},8,["show"]),Object(c["k"])(A,{show:v.state.popup2,"onUpdate:show":e[8]||(e[8]=function(t){return v.state.popup2=t}),title:"派发优惠券"},{default:a((function(){return[Object(c["k"])("div",k,[Object(c["k"])(G,{type:"textarea",modelValue:v.state.account,"onUpdate:modelValue":e[6]||(e[6]=function(t){return v.state.account=t}),style:{border:"solid 1px #EE"},autosize:{minHeight:200},"input-align":"center",placeholder:"请点击这里选择要派发的员工账号",clearable:"",readonly:"",onClick:e[7]||(e[7]=function(t){return v.state.showMember=!0})},null,8,["modelValue"]),Object(c["k"])(C,{round:"",block:"",type:"primary",style:{margin:"10px 0"},onClick:w.onGrant},{default:a((function(){return[g]})),_:1},8,["onClick"])])]})),_:1},8,["show"]),Object(c["k"])(A,{show:v.state.showMember,"onUpdate:show":e[11]||(e[11]=function(t){return v.state.showMember=t}),title:"请点击选择员工",style:{height:"100%",maxHeight:"100%",background:"#F6F6F6"},round:!1,closeable:!1},{default:a((function(){return[Object(c["k"])(H,{selected:v.state.account,"onUpdate:selected":e[9]||(e[9]=function(t){return v.state.account=t}),onClose:e[10]||(e[10]=function(t){return v.state.showMember=!1})},null,8,["selected"])]})),_:1},8,["show"])]})),_:1})})),m=n("e224"),w=(n("9632"),n("d959")),C=n.n(w);const _=C()(m["a"],[["render",v],["__scopeId","data-v-dc22f0c6"]]);e["default"]=_},e224:function(t,e,n){"use strict";(function(t){n("a9e3"),n("ac1f"),n("5319"),n("caad"),n("2532"),n("9911");var c=n("7a23"),a=n("2824"),i=n("6c74"),o=n("0ac3");e["a"]={components:{BaseLayout:a["a"],VanCode:i["a"],Member:o["default"]},props:{invalid:{type:[String,Number],default:0}},setup:function(){var t=Object(c["F"])(0),e=Object(c["E"])({refreshing:!1,loading:!1,finished:!1,list:[],offset:0,limit:20,popup:!1,detail:{},cid:0,pack:[],popup1:!1,showMember:!1,account:"",popup2:!1,qrcode:""});return{active:t,state:e}},created:function(){this.active=this.invalid,this.onRefresh()},methods:{onRefresh:function(){this.state.loading=!0,this.state.finished=!1,this.state.offset=0,this.state.list=[],this.onLoad()},onLoad:function(){var t=this;this.$http.get("/team/couponQuery?invalid="+this.invalid+"&offset="+this.state.offset+"&limit="+this.state.limit).then((function(e){for(var n in t.state.refreshing=!1,(0==e.length||e.length<t.state.limit)&&(t.state.finished=!0),t.state.loading=!1,t.state.offset+=e.length,e){var c=e[n];c.color=["#C00","#999"][t.invalid],c.title="满 "+Math.round(c.coupon.amount,2)+" 元"+(1==c.coupon.type?"<br>减 "+c.coupon.discount+" 元":"打 "+c.coupon.discount+" 折"),t.state.list.push(c)}}))},onChange:function(){this.$router.replace("?invalid="+this.active),setTimeout(this.onRefresh,100)},onClick:function(){this.$toast("重磅功能内测中，敬请期待！")},onChoose:function(e){this.state.cid="",t.includes(this.state.pack,e)?t.pull(this.state.pack,e):this.state.pack.push(e)},onView:function(t){var e=this;this.$http.get("/team/couponDetail?id="+t).then((function(t){e.state.detail=t,e.state.popup=!0}))},onShare:function(){var t=this,e=0==this.state.cid.length?this.state.pack:this.state.cid;this.$http.get("/team/couponShare?id="+e).then((function(e){t.state.qrcode=e.link,t.state.popup1=!0}))},onGrant:function(){var t=this;this.$http.get("/team/couponShare?id="+this.state.cid+"&uid="+this.state.account).then((function(){t.state.popup2=!1,t.$dialog.alert({title:"优惠券派发成功",message:"已微信通知员工领取使用",theme:"round-button"})}))}}}}).call(this,n("81b0"))}}]);