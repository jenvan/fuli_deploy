(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bdbf9ea"],{"54d9":function(t,e,a){},6884:function(t,e,a){"use strict";a("54d9")},bc21:function(t,e,a){"use strict";a.r(e);a("b0c0");var i=a("7a23"),s=Object(i["V"])("data-v-4a5bae41");Object(i["C"])("data-v-4a5bae41");var n={class:"main"},r={key:0},c=Object(i["i"])(" ");Object(i["A"])();var d=s((function(t,e,a,d,u,o){var l=Object(i["H"])("van-switch"),b=Object(i["H"])("van-cell"),h=Object(i["H"])("van-stepper"),p=Object(i["H"])("van-card"),j=Object(i["H"])("van-submit-bar"),m=Object(i["H"])("pay"),O=Object(i["H"])("BaseLayout");return Object(i["z"])(),Object(i["g"])(O,{title:"确认订单"},{default:s((function(){return[Object(i["j"])("div",n,[u.state.digiCard?Object(i["h"])("",!0):(Object(i["z"])(),Object(i["g"])("div",r,[Object(i["j"])(b,{title:"生成提货卡",border:!1},{"right-icon":s((function(){return[c,Object(i["j"])(l,{modelValue:u.state.pickCard,"onUpdate:modelValue":e[1]||(e[1]=function(t){return u.state.pickCard=t}),size:"24"},null,8,["modelValue"])]})),_:1}),Object(i["S"])(Object(i["j"])(b,{title:"提货卡数量"},{"right-icon":s((function(){return[Object(i["j"])(h,{modelValue:u.state.number,"onUpdate:modelValue":e[2]||(e[2]=function(t){return u.state.number=t}),theme:"round","button-size":"22",max:9999},null,8,["modelValue"])]})),_:1},512),[[i["O"],u.state.pickCard]]),Object(i["S"])(Object(i["j"])("div",null,[u.state.addr&&u.state.addr.name?(Object(i["z"])(),Object(i["g"])(b,{key:0,class:"card",size:"large",icon:"location",title:u.state.addr.name+" "+u.state.addr.mobile,label:u.state.addr.province+u.state.addr.city+u.state.addr.county+u.state.addr.address,to:"/my/address/choose?target="+o.target,"is-link":"",center:""},null,8,["title","label","to"])):(Object(i["z"])(),Object(i["g"])(b,{key:1,class:"card",size:"large",title:"新增收货地址",to:"/my/address/add?target="+o.target,"is-link":""},null,8,["to"]))],512),[[i["O"],!u.state.pickCard]])])),(Object(i["z"])(!0),Object(i["g"])(i["a"],null,Object(i["F"])(u.state.list,(function(t,e){return Object(i["z"])(),Object(i["g"])(p,{class:"item",key:e,title:t.title,desc:t.spec,thumb:t.image,price:t.price,num:t.num},null,8,["title","desc","thumb","price","num"])})),128)),Object(i["j"])(j,{label:"总金额：","button-text":"结算",style:{bottom:"50px"},price:100*o.total,disabled:0==o.total,onSubmit:o.buy},null,8,["price","disabled","onSubmit"]),Object(i["j"])(m,Object(i["q"])(u.state.payData,{show:u.state.payShow,"onUpdate:show":e[3]||(e[3]=function(t){return u.state.payShow=t}),onOnFinish:o.handlePay}),null,16,["show","onOnFinish"])])]})),_:1})})),u=a("c11d"),o=(a("6884"),a("6b0d")),l=a.n(o);const b=l()(u["a"],[["render",d],["__scopeId","data-v-4a5bae41"]]);e["default"]=b},c11d:function(t,e,a){"use strict";(function(t){var i=a("5530"),s=(a("a9e3"),a("7a23")),n=a("5502"),r=a("2824"),c=a("a6e6");e["a"]={components:{BaseLayout:r["a"],Pay:c["default"]},props:{direct:{type:[String,Number],default:0},digital:{type:[String,Number],default:0},aid:{type:[String,Number],default:0}},data:function(){var t=Object(s["D"])({addr:{},list:[],number:1,amount:0,pickCard:!1,digiCard:!1,payData:{},payShow:!1});return{state:t}},created:function(){var e=this;this.state.digiCard=this.digital>0,this.$http.get("/mall/addresslist").then((function(a){for(var i in a)if(0==e.aid&&2==a[i].status||a[i].id==e.aid){e.state.addr=a[i];break}t.isEmpty(e.state.addr)&&!t.isEmpty(a)&&(e.state.addr=a[0])})),this.$http.get("/mall/cartlist?status="+(parseInt(this.direct)+1)).then((function(t){e.state.list=t;var a=0;for(var i in e.state.list)a+=e.state.list[i].price*e.state.list[i].num;e.state.amount=a}))},computed:Object(i["a"])({target:function(){return escape(this.$route.fullPath)},total:function(){return this.state.pickCard?this.state.amount*this.state.number:this.state.amount}},Object(n["d"])(["profile"])),methods:{buy:function(){var e=this;if(t.isEmpty(this.state.addr)&&!this.state.pickCard&&!this.state.digiCard)return this.$toast("请先选择收货地址");var a=0;this.state.pickCard&&(a=this.state.number),this.state.digiCard&&(a=-1),this.$http.post("/mall/checkout?aid="+(this.state.pickCard||this.state.digiCard?0:this.state.addr.id)+"&card="+a+"&direct="+this.direct).then((function(t){e.state.payData=Object(i["a"])(Object(i["a"])({},t),{},{json:JSON.stringify(t)}),e.state.payShow=!0}))},handlePay:function(t){var e=this;this.state.payShow=!1,this.$dialog.alert({title:"订单支付"+(t?"成功":"失败"),message:"请在“我的订单”中查看详细情况",theme:"round-button"}).then((function(){e.$router.push("/my/order")}))}}}}).call(this,a("81b0"))}}]);