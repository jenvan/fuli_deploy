(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3cd7ba5a"],{"69fb":function(t,e,n){"use strict";n.r(e);n("b0c0"),n("b64b"),n("ac1f"),n("5319");var a=n("7a23"),c=Object(a["X"])("data-v-afdd075e");Object(a["D"])("data-v-afdd075e");var r=Object(a["j"])("已下单"),o=Object(a["j"])("已付款"),i=Object(a["j"])("已发货"),s=Object(a["j"])("已签收"),l={key:0},u={class:"wait"},d=Object(a["k"])("br",null,null,-1),b=Object(a["j"])("卡密尚未发货 "),j={class:"card"},O={class:"tool"},f=Object(a["j"])(" 复制卡密"),p=Object(a["j"])("   "),h=Object(a["j"])(" 查看卡片"),k={class:"van-multi-ellipsis--l2"},v=Object(a["k"])("br",null,null,-1),g=Object(a["j"])("长按图片保存到手机或分享给好友");Object(a["B"])();var y=c((function(t,e,n,y,m,C){var w=Object(a["I"])("van-step"),_=Object(a["I"])("van-steps"),I=Object(a["I"])("van-cell"),M=Object(a["I"])("van-icon"),x=Object(a["I"])("van-swipe-item"),A=Object(a["I"])("van-swipe"),$=Object(a["I"])("van-collapse-item"),L=Object(a["I"])("van-collapse"),U=Object(a["I"])("van-divider"),F=Object(a["I"])("van-action-bar-icon"),S=Object(a["I"])("van-action-bar-button"),D=Object(a["I"])("van-action-bar"),P=Object(a["I"])("van-image"),V=Object(a["I"])("van-popup"),E=Object(a["I"])("pay"),H=Object(a["I"])("BaseLayout");return Object(a["A"])(),Object(a["g"])(H,{title:"订单详情",subtitle:"# "+n.id},{default:c((function(){return[Object(a["U"])(Object(a["k"])(_,{class:"step",active:y.status},{default:c((function(){return[Object(a["k"])(w,null,{default:c((function(){return[r]})),_:1}),Object(a["k"])(w,null,{default:c((function(){return[o]})),_:1}),Object(a["k"])(w,null,{default:c((function(){return[i]})),_:1}),Object(a["k"])(w,null,{default:c((function(){return[s]})),_:1})]})),_:1},8,["active"]),[[a["Q"],y.status<4]]),y.state.order.channel>0?(Object(a["A"])(),Object(a["g"])(I,{key:0,title:t.channel[y.state.order.channel]["name"]+"单号",value:y.state.order.extra,border:!1,onClick:e[1]||(e[1]=function(e){return t.$copy(y.state.order.extra)})},null,8,["title","value"])):Object(a["h"])("",!0),Object(a["k"])(L,{class:"bill",modelValue:y.unfold,"onUpdate:modelValue":e[2]||(e[2]=function(t){return y.unfold=t})},{default:c((function(){return[Object(a["k"])($,{name:"0",title:"收货信息",value:0==y.state.order.card?"物流派送":y.state.order.card<0?"电子卡密":"提货卡"},{default:c((function(){return[0==y.state.order.card?(Object(a["A"])(),Object(a["g"])("div",l,[Object(a["k"])(I,null,{title:c((function(){return[Object(a["j"])(Object(a["M"])(y.state.order.consignee.name)+"（"+Object(a["M"])(y.state.order.consignee.mobile)+"）",1)]})),label:c((function(){return[Object(a["j"])(Object(a["M"])(y.state.order.consignee.province)+" "+Object(a["M"])(y.state.order.consignee.city)+" "+Object(a["M"])(y.state.order.consignee.county)+" "+Object(a["M"])(y.state.order.consignee.address),1)]})),_:1}),(Object(a["A"])(!0),Object(a["g"])(a["a"],null,Object(a["G"])(y.state.order.logistics,(function(e,c,r){return Object(a["A"])(),Object(a["g"])(I,{key:c,title:e.dt+(Object.keys(y.state.order.logistics).length>1?"（包裹 "+(r+1)+"）":""),label:e.msg,border:"","is-link":"",onClick:function(e){return t.$router.push("/my/order/track?id="+n.id+"&lid="+c)}},null,8,["title","label","onClick"])})),128))])):(Object(a["A"])(),Object(a["g"])(A,{key:1,class:"swipe"},{indicator:c((function(t){var e=t.active;return[Object(a["U"])(Object(a["k"])("div",{class:"indicator"},Object(a["M"])(e+1)+" / "+Object(a["M"])(y.state.cards.length),513),[[a["Q"],y.state.cards.length>0]])]})),default:c((function(){return[Object(a["U"])(Object(a["k"])("div",u,[Object(a["k"])(M,{name:"card",size:"96"}),d,b],512),[[a["Q"],0==y.state.cards.length]]),(Object(a["A"])(!0),Object(a["g"])(a["a"],null,Object(a["G"])(y.state.cards,(function(t,e){return Object(a["A"])(),Object(a["g"])(x,{key:e,style:{background:t.bg}},{default:c((function(){return[Object(a["k"])("div",j,[Object(a["j"])(Object(a["M"])(y.state.order.card>0?"提货卡号：":"")+"**** ",1),Object(a["k"])("span",{innerHTML:t.token.substr(4).replace(/([\s|\|,]+)/gm,"<br>")},null,8,["innerHTML"])]),Object(a["k"])("div",O,[Object(a["k"])(M,{name:"more-o",onClick:function(e){return C.onFinish()&C.copy(t.token)}},{default:c((function(){return[f]})),_:2},1032,["onClick"]),p,Object(a["k"])(M,{name:"photo-o",onClick:function(e){return C.onFinish()&C.share(t.token,t.deadline)}},{default:c((function(){return[h]})),_:2},1032,["onClick"])]),Object(a["U"])(Object(a["k"])("div",{class:"deadline"}," 有效期至："+Object(a["M"])(t.deadline.substr(0,10)),513),[[a["Q"],t.deadline&&t.deadline.length>0]])]})),_:2},1032,["style"])})),128))]})),_:1}))]})),_:1},8,["value"]),Object(a["k"])($,{name:"1",title:"商品信息",value:"共 "+(y.state.order.card<=0?y.state.order.total:y.state.order.card+" x "+y.state.order.total/y.state.order.card)+" 件"},{default:c((function(){return[(Object(a["A"])(!0),Object(a["g"])(a["a"],null,Object(a["G"])(y.state.order.detail,(function(t,e){return Object(a["A"])(),Object(a["g"])(I,{key:e,label:t.spec,style:{alignItems:"center"},onClick:function(e){return C.onView(t)}},{icon:c((function(){return[Object(a["k"])(M,{class:"img",name:t.image,size:"32"},null,8,["name"])]})),title:c((function(){return[Object(a["k"])("div",k,Object(a["M"])(t.title),1)]})),extra:c((function(){return[Object(a["j"])(" x"+Object(a["M"])(t.num),1)]})),_:2},1032,["label","onClick"])})),128))]})),_:1},8,["value"]),Object(a["k"])($,{name:"2",title:"订单总额",value:y.state.order.amount+" 元"},{default:c((function(){return[Object(a["k"])(I,{title:"实付积分",value:y.state.order.point+" 分"},null,8,["value"]),Object(a["k"])(I,{title:"实付现金",value:y.state.order.cash+" 元"},null,8,["value"])]})),_:1},8,["value"]),Object(a["k"])($,{name:"3",title:"交易状态"},{value:c((function(){return[Object(a["k"])("div",{style:{color:y.state.order.color}},Object(a["M"])(y.state.order.result),5)]})),default:c((function(){return[Object(a["k"])(I,{title:"创建时间",value:y.state.order.dt_create},null,8,["value"]),Object(a["k"])(I,{title:"付款时间",value:y.state.order.dt_pay},null,8,["value"]),Object(a["k"])(I,{title:"发货时间",value:y.state.order.dt_send},null,8,["value"]),Object(a["k"])(I,{title:"完成时间",value:y.state.order.dt_finish},null,8,["value"])]})),_:1})]})),_:1},8,["modelValue"]),Object(a["k"])(U,{style:{color:"#EEE"},onClick:e[3]||(e[3]=function(e){return t.$copy(n.id+" "+y.state.order.extra)})},{default:c((function(){return[Object(a["j"])("# "+Object(a["M"])(n.id)+" #",1)]})),_:1}),Object(a["k"])(D,null,{default:c((function(){return[Object(a["k"])(F,{icon:"chat-o",text:"客服",onClick:e[4]||(e[4]=function(t){return y.state.popup2=!0})}),0==y.state.order.status?(Object(a["A"])(),Object(a["g"])(S,{key:0,type:"warning",text:"关闭订单",onClick:C.onClose},null,8,["onClick"])):Object(a["h"])("",!0),0==y.state.order.status?(Object(a["A"])(),Object(a["g"])(S,{key:1,type:"primary",text:"立即付款",onClick:C.onPay},null,8,["onClick"])):Object(a["h"])("",!0),0==y.state.order.card&&2==y.state.order.status?(Object(a["A"])(),Object(a["g"])(S,{key:2,type:"success",text:"确认收货",onClick:C.onFinish},null,8,["onClick"])):Object(a["h"])("",!0),0==y.state.order.card&&y.state.order.status>0&&y.state.order.status<4?(Object(a["A"])(),Object(a["g"])(S,{key:3,type:"danger",text:"申请售后",onClick:C.onService},null,8,["onClick"])):Object(a["h"])("",!0)]})),_:1}),Object(a["k"])(V,{show:y.state.popup1,"onUpdate:show":e[5]||(e[5]=function(t){return y.state.popup1=t})},{default:c((function(){return[Object(a["k"])(P,{class:"giftcard",src:y.state.giftcard,width:"300"},{default:c((function(){return[v,g]})),_:1},8,["src"])]})),_:1},8,["show"]),Object(a["k"])(V,{show:y.state.popup2,"onUpdate:show":e[6]||(e[6]=function(t){return y.state.popup2=t}),position:"top",style:{height:"50%",padding:"20px"}},{default:c((function(){return[Object(a["k"])("div",{class:"contact",innerHTML:t.config.contact},null,8,["innerHTML"])]})),_:1},8,["show"]),Object(a["k"])(E,Object(a["r"])(y.state.payData,{show:y.state.payShow,"onUpdate:show":e[7]||(e[7]=function(t){return y.state.payShow=t}),onOnFinish:C.handlePay}),null,16,["show","onOnFinish"])]})),_:1},8,["subtitle"])})),m=n("e74a"),C=(n("a49f"),n("d959")),w=n.n(C);const _=w()(m["a"],[["render",y],["__scopeId","data-v-afdd075e"]]);e["default"]=_},8455:function(t,e,n){},a49f:function(t,e,n){"use strict";n("8455")},e74a:function(t,e,n){"use strict";(function(t){var a=n("53ca"),c=n("5530"),r=(n("a9e3"),n("7a23")),o=n("5502"),i=n("2824"),s=n("a6e6");e["a"]={components:{BaseLayout:i["a"],Pay:s["default"]},props:{id:{type:[String,Number],default:0}},setup:function(){var t=Object(r["E"])({order:{},cards:[],popup1:!1,giftcard:"",popup2:!1,payData:{},payShow:!1}),e=Object(r["F"])(0),n=Object(r["F"])(["0","1"]),a=Object(r["F"])(0);return{state:t,status:e,unfold:n,active:a}},created:function(){this.onLoad()},computed:Object(c["a"])({},Object(o["d"])(["channel","config"])),methods:{onLoad:function(){var e=this;this.state.cards=[],this.$http.post("/mall/orderDetail?id="+this.id).then((function(n){if(e.state.order=n,e.state.order.color=["#CCC","#666","#00C","#0C0","#C00"][n.status],e.state.order.result=["未付款","已付款","已发货","交易成功","交易关闭"][n.status],e.status=n.status,0!=n.card){for(var a in n.cards)n.cards[a].bg="rgb("+t.random(150,250)+","+t.random(150,250)+","+t.random(150,250)+")";e.state.cards=n.cards}n.channel>0&&n.status>0&&e.$http.get("/"+e.channel[n.channel]["type"]+"/orderUpdate?id="+e.id)}))},onView:function(t){var e="/mall/item?id="+t.spu;this.state.order.channel>0&&(e="/"+this.channel[this.state.order.channel]["type"]+"/item?id="+t.spu),this.$router.push(e)},onPay:function(){var t=this,e="/mall/pay";this.state.order.channel>0&&(e="/"+this.channel[this.state.order.channel]["type"]+"/pay"),this.$http.post(e+"?oid="+this.id).then((function(e){t.state.payData=Object(c["a"])(Object(c["a"])({},e),{},{json:JSON.stringify(e)}),t.state.payShow=!0}))},onClose:function(){0==this.state.order.status&&this.$http.post("/mall/orderClose?id="+this.id).then(this.onLoad)},onFinish:function(){2==this.state.order.status&&this.$http.post("/mall/orderFinish?id="+this.id).then(this.onLoad)},onService:function(){this.$router.push("/my/service?id="+this.id)},handlePay:function(t){this.state.payShow=!1,this.$dialog.alert({message:"订单支付"+(t?"成功":"失败"),theme:"round-button"}).then(this.onLoad)},copy:function(t){this.$copy(t,"已复制到剪贴板\n建议采用图片方式分享")},share:function(t,e){var n=this.state.order.card>0?"pick":"",c="string"==typeof this.state.order.detail[0]["digital"]?JSON.parse(this.state.order.detail[0]["digital"]):{};console.log(c),"string"==typeof c["tag"]&&/^gift/i.test(c["tag"])&&(n="gift");var r=this.$host+"/mall/card?type="+n+"&token="+encodeURIComponent(t)+"&deadline="+encodeURIComponent(e);"object"==Object(a["a"])(c)&&("string"==typeof c["bg"]&&(r+="&bg="+c["bg"]),"undefined"!=typeof c["x"]&&(r+="&x="+c["x"]),"undefined"!=typeof c["y"]&&(r+="&y="+c["y"]),r+="&qr="+(c["qr"]?c["qr"]:0)),this.state.giftcard=r,this.state.popup1=!0}}}}).call(this,n("81b0"))}}]);