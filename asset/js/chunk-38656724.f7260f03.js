(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38656724"],{"40fe":function(t,e,a){"use strict";(function(t){var i=a("5530"),n=(a("a9e3"),a("7a23")),r=a("5502"),s=a("2824");e["a"]={components:{BaseLayout:s["a"]},props:{type:{type:String,default:"mall"},direct:{type:[String,Number],default:0},aid:{type:[String,Number],default:0}},data:function(){var t=Object(n["B"])({addr:{},list:[],number:1,amount:0,makeCard:!1,useCash:!1,usePoint:!1});return{state:t}},created:function(){var e=this;this.$http.get("/mall/addresslist").then((function(a){for(var i in a)if(0==e.aid&&2==a[i].status||a[i].id==e.aid){e.state.addr=a[i];break}t.isEmpty(e.state.addr)&&!t.isEmpty(a)&&(e.state.addr=a[0])})),this.$http.get("/mall/cartlist?status="+(parseInt(this.direct)+1)).then((function(t){e.state.list=t;var a=0;for(var i in e.state.list)a+=e.state.list[i].price*e.state.list[i].num;e.state.amount=a}))},computed:Object(i["a"])({target:function(){return escape(this.$route.fullPath)},total:function(){return this.state.makeCard?this.state.amount*this.state.number:this.state.amount},amount:function(){var e=0;return e=this.state.usePoint&&this.state.useCash?this.total-this.profile.point-this.profile.cash:this.state.usePoint?this.total-this.profile.point:this.state.useCash?this.total-this.profile.cash:this.total,t.max([e,0])}},Object(r["d"])(["profile"])),methods:{deposit:function(){this.$router.push("/my/deposit")},buy:function(){var e=this;if(!this.state.makeCard&&t.isEmpty(this.state.addr))return this.$toast("请先选择收货地址");this.$http.post("/mall/bill?aid="+(this.state.makeCard?0:this.state.addr.id)+"&card="+(this.state.makeCard?this.state.number:0)+"&direct="+this.direct).then((function(t){var a="";e.state.usePoint&&!e.state.useCash&&(a="point"),!e.state.usePoint&&e.state.useCash&&(a="cash"),e.$http.post("/mall/pay?id="+t["id"]+"&type="+a).then((function(){e.$router.push("/my/order")}))}))}}}}).call(this,a("81b0"))},4283:function(t,e,a){"use strict";a("d040")},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var i=a("1d80"),n=a("5899"),r="["+n+"]",s=RegExp("^"+r+r+"*"),c=RegExp(r+r+"*$"),u=function(t){return function(e){var a=String(i(e));return 1&t&&(a=a.replace(s,"")),2&t&&(a=a.replace(c,"")),a}};t.exports={start:u(1),end:u(2),trim:u(3)}},7156:function(t,e,a){var i=a("861d"),n=a("d2bb");t.exports=function(t,e,a){var r,s;return n&&"function"==typeof(r=e.constructor)&&r!==a&&i(s=r.prototype)&&s!==a.prototype&&n(t,s),t}},a9e3:function(t,e,a){"use strict";var i=a("83ab"),n=a("da84"),r=a("94ca"),s=a("6eeb"),c=a("5135"),u=a("c6b6"),o=a("7156"),l=a("c04e"),d=a("d039"),f=a("7c73"),b=a("241c").f,p=a("06cf").f,h=a("9bf2").f,m=a("58a8").trim,O="Number",j=n[O],v=j.prototype,g=u(f(v))==O,y=function(t){var e,a,i,n,r,s,c,u,o=l(t,!1);if("string"==typeof o&&o.length>2)if(o=m(o),e=o.charCodeAt(0),43===e||45===e){if(a=o.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(o.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+o}for(r=o.slice(2),s=r.length,c=0;c<s;c++)if(u=r.charCodeAt(c),u<48||u>n)return NaN;return parseInt(r,i)}return+o};if(r(O,!j(" 0o1")||!j("0b1")||j("+0x1"))){for(var k,C=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof C&&(g?d((function(){v.valueOf.call(a)})):u(a)!=O)?o(new j(y(e)),a,C):y(e)},I=i?b(j):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),N=0;I.length>N;N++)c(j,k=I[N])&&!c(C,k)&&h(C,k,p(j,k));C.prototype=v,v.constructor=C,s(n,O,C)}},bc21:function(t,e,a){"use strict";a.r(e);a("b0c0");var i=a("7a23"),n=Object(i["R"])("data-v-1b3c429b");Object(i["A"])("data-v-1b3c429b");var r={class:"main"},s=Object(i["h"])(" "),c=Object(i["h"])(" "),u=Object(i["h"])(" ");Object(i["y"])();var o=n((function(t,e,a,o,l,d){var f=Object(i["F"])("van-switch"),b=Object(i["F"])("van-cell"),p=Object(i["F"])("van-stepper"),h=Object(i["F"])("van-card"),m=Object(i["F"])("van-cell-group"),O=Object(i["F"])("van-submit-bar"),j=Object(i["F"])("BaseLayout");return Object(i["x"])(),Object(i["f"])(j,{title:"确认订单"},{default:n((function(){return[Object(i["i"])("div",r,[Object(i["i"])(b,{title:"生成提货卡",border:!1},{"right-icon":n((function(){return[s,Object(i["i"])(f,{modelValue:l.state.makeCard,"onUpdate:modelValue":e[1]||(e[1]=function(t){return l.state.makeCard=t}),size:"24"},null,8,["modelValue"])]})),_:1}),Object(i["P"])(Object(i["i"])(b,{title:"提货卡数量"},{"right-icon":n((function(){return[Object(i["i"])(p,{modelValue:l.state.number,"onUpdate:modelValue":e[2]||(e[2]=function(t){return l.state.number=t}),theme:"round","button-size":"22",max:9999},null,8,["modelValue"])]})),_:1},512),[[i["M"],l.state.makeCard]]),Object(i["P"])(Object(i["i"])("div",null,[l.state.addr&&l.state.addr.name?(Object(i["x"])(),Object(i["f"])(b,{key:0,class:"card",size:"large",icon:"location",title:l.state.addr.name+" "+l.state.addr.mobile,label:l.state.addr.province+l.state.addr.city+l.state.addr.district+l.state.addr.address,to:"/my/address/choose?target="+d.target,"is-link":"",center:""},null,8,["title","label","to"])):(Object(i["x"])(),Object(i["f"])(b,{key:1,class:"card",size:"large",title:"新增收货地址",to:"/my/address/add?target="+d.target,"is-link":""},null,8,["to"]))],512),[[i["M"],!l.state.makeCard]]),(Object(i["x"])(!0),Object(i["f"])(i["a"],null,Object(i["D"])(l.state.list,(function(t,e){return Object(i["x"])(),Object(i["f"])(h,{class:"item",key:e,title:t.title,desc:t.spec,thumb:t.image,price:t.price,num:t.num},null,8,["title","desc","thumb","price","num"])})),128)),Object(i["i"])(m,{class:"fee"},{default:n((function(){return[Object(i["i"])(b,{title:"商品总金额",value:d.total+" 元"},null,8,["value"]),Object(i["i"])(b,{title:"使用优惠券",value:"无","is-link":""}),Object(i["i"])(b,{title:"使用余额支付",value:"（"+t.profile.cash+" 可用）"},{"right-icon":n((function(){return[c,Object(i["i"])(f,{modelValue:l.state.useCash,"onUpdate:modelValue":e[3]||(e[3]=function(t){return l.state.useCash=t}),size:"24"},null,8,["modelValue"])]})),_:1},8,["value"]),Object(i["i"])(b,{title:"使用积分支付",value:"（"+t.profile.point+" 可用）"},{"right-icon":n((function(){return[u,Object(i["i"])(f,{modelValue:l.state.usePoint,"onUpdate:modelValue":e[4]||(e[4]=function(t){return l.state.usePoint=t}),size:"24"},null,8,["modelValue"])]})),_:1},8,["value"])]})),_:1}),Object(i["i"])(O,{label:"待支付总金额：","button-text":"结算",style:{bottom:"50px"},price:100*d.amount,disabled:d.amount>0,onSubmit:d.buy},{top:n((function(){return[Object(i["P"])(Object(i["i"])("div",{class:"notify",onClick:e[5]||(e[5]=function(){return d.deposit&&d.deposit.apply(d,arguments)})},"账户资产不足，请充值后再来结算 >>>",512),[[i["M"],d.total-t.profile.cash-t.profile.point>0]])]})),_:1},8,["price","disabled","onSubmit"])])]})),_:1})})),l=a("40fe");a("4283");l["a"].render=o,l["a"].__scopeId="data-v-1b3c429b";e["default"]=l["a"]},d040:function(t,e,a){}}]);
//# sourceMappingURL=chunk-38656724.f7260f03.js.map