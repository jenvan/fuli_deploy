{"version":3,"sources":["webpack:///./src/views/Mall/Cart.vue","webpack:///./src/views/Mall/Cart.vue?e34d","webpack:///./src/views/Mall/Cart.vue?481e"],"names":["components","BaseLayout","data","state","list","total","amount","created","this","authorized","$http","get","then","i","item","push","checked","status","stock","stat","computed","empty","_","isEmpty","methods","getError","index","parseInt","num","price","onRemove","id","like","post","omit","onChange","obj","has","onSubmit","$notify","$router","class","title","subtitle","description","type","size","to","key","justify","align","span","disabled","length","width","height","radius","fit","src","image","spu","right","square","text","border","label","spec","center","theme","button-size","min","max","integer","style","button-text","render","__scopeId"],"mappings":"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","file":"asset/js/chunk-56aa7068.4205f080.js","sourcesContent":["<template>\n  <BaseLayout title=\"购物车\" subtitle=\"更多操作请按住商品标题左滑\">\n\n    <div class=\"list\">\n\n      <van-empty v-show=\"empty\" description=\"购物车空空如也 ~\">\n        <van-button v-show=\"!authorized\" type=\"primary\" size=\"small\" to=\"/login\">请先登录</van-button>\n      </van-empty>\n\n      <van-row v-for=\"(item, index) in state.list\" :key=\"index\" class=\"item\" justify=\"space-between\" align=\"center\">\n        <van-col class=\"check\" :span=\"2\">\n          <van-checkbox v-model=\"state.list[index].checked\" :disabled=\"getError(index).length > 0\" @change=\"onChange(item.id, {status: state.list[index].checked})\"></van-checkbox>\n        </van-col>\n        <van-col class=\"image\" :span=\"6\">\n          <van-image width=\"100%\" height=\"100%\" radius=\"5\" fit=\"contain\" :src=\"item.image\" @click=\"$router.push('item?id=' + item.spu)\"></van-image>\n        </van-col>\n        <van-col class=\"intro\" :span=\"16\">\n          <van-swipe-cell>\n            <template #right>\n              <div class=\"operate\">\n                <van-button square type=\"primary\" text=\"收藏\" @click=\"onRemove(index, item.id, 1)\" />\n                <van-button square type=\"danger\"  text=\"删除\" @click=\"onRemove(index, item.id)\" />\n              </div>\n            </template>\n            <van-cell :border=\"false\" @click=\"$router.push('item?id=' + item.spu)\">\n              <template #title><div class=\"van-ellipsis\">{{item.title}}</div></template>\n              <template #label><div class=\"van-ellipsis\">{{item.spec}}</div></template>\n            </van-cell>\n            <van-cell :border=\"false\" center>\n              <template #title>\n                <span class=\"price\"><span class=\"red\">￥</span> {{item.price}} </span>\n              </template>\n              <van-stepper v-model=\"state.list[index].num\" theme=\"round\" button-size=\"22\" min=\"1\" :max=\"item.stock\" :disabled=\"item.status<0\" integer @change=\"onChange(item.id, {num:state.list[index].num})\" />\n            </van-cell>\n          </van-swipe-cell>\n        </van-col>\n        <div class=\"error\" v-show=\"getError(index).length > 0\">{{getError(index)}}</div>\n      </van-row>\n\n      <van-submit-bar :style=\"{bottom:'50px'}\" :price=\"state.amount*100\" :button-text=\"'去结算(' + state.total + ')'\" @submit=\"onSubmit\">\n        <!-- <template #tip>\n          你的收货地址不支持同城送, <span @click=\"onClickLink\">修改地址</span>\n        </template> -->\n      </van-submit-bar>\n\n    </div>\n\n  </BaseLayout>\n</template>\n\n<style scoped>\n.list {\n  margin: 10px 0;\n  padding-bottom: 80px;\n  min-height: 500px;\n  background: #F3F3F3;\n  border-radius: 5px;\n}\n\n.item {\n  position: relative;\n  height: 130px;\n  margin: 10px;\n  background: #FFF;\n  border-radius: 5px;\n  text-align: center;\n  overflow: hidden;\n}\n.check {\n  padding-left: 5px;\n}\n.image {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.intro {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: space-between;\n  text-align: left;\n}\n.price {\n  font-size: 16px;\n}\n.red {\n  color: #F00;\n}\n\n.operate {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: space-between;\n}\n.error {\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 3px;\n  background: #CCC;\n  border-radius: 0 0 0 5px;\n  font-size: 9px;\n}\n\n</style>\n\n<script>\nimport {reactive, ref} from 'vue'\nimport {mapState, mapGetters, mapMutations} from 'vuex'\nimport BaseLayout from '@/components/BaseLayout.vue'\n\nexport default {\n  components: {BaseLayout},\n\n  data() {\n    const state = reactive({\n      list: [],\n      total: 0,\n      amount: 0,\n    });\n    return {state};\n  },\n\n  created() {\n    this.authorized && this.$http.get(\"/mall/cartlist\").then((data) => {\n      for (let i in data){\n        let item = data[i];\n        this.state.list.push({...item, ...{\n          checked: item.status == 1 && item.stock > 0,\n        }});\n      }\n      this.stat();\n    });\n  },\n\n  computed: {\n    empty() {\n      return _.isEmpty(this.state.list);\n    },\n    ...mapGetters([\"authorized\"]),\n  },\n\n  methods: {\n    getError(index) {\n      if (typeof this.state.list[index] != \"object\")\n        return \"\";\n      if (this.state.list[index].status < 0)\n        return \"已下架\";\n      if (this.state.list[index].stock == 0)\n        return \"零库存\";\n      return \"\";\n    },\n\n    stat() {\n      let total = 0;\n      let amount = 0;\n      for (let i in this.state.list){\n        let item = this.state.list[i];\n        if (item.checked){\n          total += parseInt(item.num);\n          amount += parseInt(item.num) * item.price;\n        }\n      }\n      this.state.total = total;\n      this.state.amount = amount;\n    },\n\n    onRemove(index, id, like = 0) {\n      this.$http.post(\"/mall/cartsave?id=\" + id + \"&remove=1&like=\" + like).then(() => {\n        this.state.list = _.omit(this.state.list, index);\n        this.stat();\n      });\n    },\n\n    onChange(id, obj) {\n      typeof obj == \"object\" && this.$http.get(\"/mall/cartsave?id=\" + id + (_.has(obj, \"num\") ? \"&num=\" + obj.num : \"\") + (_.has(obj, \"status\") ? \"&status=\" + (obj.status ? 1 : 0) : \"\") ).then(() => {\n        this.stat();\n      });\n    },\n\n    onSubmit() {\n      if (this.state.total == 0) {\n        return this.$notify(\"请先选择要结算的商品\");\n      }\n      this.$router.push(\"bill\");\n    },\n  },\n}\n</script>\n","import { render } from \"./Cart.vue?vue&type=template&id=5322bc82&scoped=true\"\nimport script from \"./Cart.vue?vue&type=script&lang=js\"\nexport * from \"./Cart.vue?vue&type=script&lang=js\"\n\nimport \"./Cart.vue?vue&type=style&index=0&id=5322bc82&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-5322bc82\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Cart.vue?vue&type=style&index=0&id=5322bc82&scoped=true&lang=css\""],"sourceRoot":""}